<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<!--    <script src="https://remoteme.org/public/libs/remoteme/remoteMe.js"></script>-->
    <script type="text/javascript">
        "use strict";var _createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}WebrtcConnectingStatusEnum={CONNECTED:0,DISCONNECTED:1,FAILED:2,CONNECTING:3,DISCONNECTING:4,CHECKING:5},WebsocketConnectingStatusEnum={CONNECTED:0,DISCONNECTED:1,ERROR:2};var RemoteMe=function(){function a(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;if(_classCallCheck(this,a),void 0!=a.thiz)throw console.error("Remoteme tried to construct more then once"),"Remoteme tried to construct twice";a.thiz=this,a.thiz.messageUserSyncIdToFunction=[];if(this.directWebSocket=[],this.pingWebSocketTimer,this.remoteMeConfig,this.webSocket,this.openedChanel=void 0,this.messageCounter=0,this.peerConnection,this.variables=void 0,this.remoteMeConfig={automaticlyConnectWS:!0,automaticlyConnectWebRTC:!1,webSocketConnectionChange:void 0,webRtcConnectionChange:void 0,onUserMessage:void 0,onUserSyncMessage:void 0,pcConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},pcOptions:{optional:[{DtlsSrtpKeyAgreement:!0}]},mediaConstraints:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}}},void 0!=d)for(var c in d)this.remoteMeConfig[c]=d[c];this.remoteMeConfig.automaticlyConnectWS&&this.connectWebSocket(),window.onbeforeunload=function(){this.disconnectWebSocket(),this.disconnectWebRTC()}.bind(this)}return _createClass(a,[{key:"getVariables",value:function getVariables(){return void 0==this.variables&&(this.variables=new Variables(this),console.info(">>>>>>>>>>>>>")),this.variables}},{key:"log",value:function log(b){var c=(window.performance.now()/1e3).toFixed(3);console.log(c+": ",b)}},{key:"logTrace",value:function logTrace(){}},{key:"getWSUrl",value:function getWSUrl(){var b;return b="https:"==window.location.protocol?"wss://":"ws://",b+=window.location.host+"/api/ws/v1/"+thisDeviceId,b}},{key:"getRestUrl",value:function getRestUrl(){return window.location.protocol+"//"+window.location.host+"/api/rest/v1/"}},{key:"connectWebSocket",value:function connectWebSocket(){this.log("connectiong WS"),this.webSocket=new WebSocket(a.thiz.getWSUrl()),this.webSocket.binaryType="arraybuffer",this.webSocket.onopen=this.onOpenWS.bind(this),this.webSocket.onmessage=this.onMessageWS.bind(this),this.webSocket.onerror=this.onErrorWS.bind(this),this.webSocket.onclose=this.onCloseWS.bind(this)}},{key:"restartWebSocket",value:function restartWebSocket(){this.isWebSocketConnected()?(this.disconnectWebSocket(),setTimeout(this.connectWebSocket.bind(this),1e3)):this.connectWebSocket()}},{key:"isWebSocketConnected",value:function isWebSocketConnected(){return void 0!=this.webSocket&&this.webSocket.readyState===this.webSocket.OPEN}},{key:"disconnectWebSocket",value:function disconnectWebSocket(){this.isWebSocketConnected()&&this.webSocket.close(),this.webSocket=void 0}},{key:"sendWebSocket",value:function sendWebSocket(b){return this.isWebSocketConnected()?(b instanceof RemoteMeData&&(b=b.getBufferArray()),this.webSocket.send(b),!0):(this.log("websocket is not opened"),!1)}},{key:"sendRest",value:function sendRest(b){b instanceof RemoteMeData&&(b=b.getBufferArray());var c=this.getRestUrl()+"message/sendMessage/",d=new XMLHttpRequest;d.responseType="arraybuffer",d.open("POST",c,!0),d.setRequestHeader("Content-type","text/plain"),d.send(b)}},{key:"sendRestSync",value:function sendRestSync(b,c){var d=this.getRestUrl()+"message/sendSyncMessage/",f=new XMLHttpRequest;f.responseType="arraybuffer",f.addEventListener("load",function(){200==this.status?c(this.response):console.error("erro while getting sync reponse "+this.statusText)}),f.open("POST",d,!0),f.setRequestHeader("Content-type","text/plain"),f.send(b)}},{key:"sendUserSyncMessageWebSocket",value:function sendUserSyncMessageWebSocket(b,c,d){var f=Math.floor(1e9*Math.random());a.thiz.messageUserSyncIdToFunction[f]=d,this.sendWebSocket(getUserSyncMessage(b,thisDeviceId,c,f))}},{key:"sendWebRTCConnectionStatusChangeMessage",value:function sendWebRTCConnectionStatusChangeMessage(b,c,d){this.sendWebSocket(getWebRTCConnectionStatusChangeMessage(b,c,d))}},{key:"sendWebSocketText",value:function sendWebSocketText(b){return this.isWebSocketConnected()?(this.webSocket.send(b),!0):(this.log("websocket is not opened"),!1)}},{key:"sendWebRtc",value:function sendWebRtc(b){this.isWebRTCConnected()?this.openedChanel.send(b):this.log("webrtc channels is not opened")}},{key:"onErrorWS",value:function onErrorWS(){this.log("on error"),this.remoteMeConfig.webSocketConnectionChange&&this.remoteMeConfig.webSocketConnectionChange(WebsocketConnectingStatusEnum.ERROR)}},{key:"onCloseWS",value:function onCloseWS(){window.clearTimeout(this.pingWebSocketTimer),this.pingWebSocketTimer=void 0,this.remoteMeConfig.webSocketConnectionChange&&this.remoteMeConfig.webSocketConnectionChange(WebsocketConnectingStatusEnum.DISCONNECTED)}},{key:"onOpenWS",value:function onOpenWS(){this.remoteMeConfig.automaticlyConnectWebRTC&&setTimeout(function(){this.connectWebRTC()}.bind(this),1e3),this.remoteMeConfig.webSocketConnectionChange&&this.remoteMeConfig.webSocketConnectionChange(WebsocketConnectingStatusEnum.CONNECTED),void 0!=this.pingWebSocketTimer&&window.clearTimeout(this.pingWebSocketTimer),this.pingWebSocketTimer=setInterval(function(){var c=new RemoteMeData(4);c.putShort(0),c.putShort(0),a.thiz.sendWebSocket(c.getBufferArray())},6e4)}},{key:"onMessageWS",value:function onMessageWS(b){if("string"==typeof b.data||b.data instanceof String){var c=!1;this.log("got websocket config ");try{var d=JSON.parse(b.data)}catch(f){c=!0}c||"send"!=d.cmd||this.doHandlePeerMessage(d.msg)}else this.processIncommingBinnaryMessage(b.data)}},{key:"processIncommingBinnaryMessage",value:function processIncommingBinnaryMessage(b){var c={},b=new RemoteMeData(b);if(c.typeId=b.popInt16(),c.typeId==MessageType.USER_MESSAGE)c.size=b.popInt16(),c.renevalWhenFailTypeId=b.popByte(),c.receiveDeviceId=b.popInt16(),c.senderDeviceId=b.popInt16(),c.messageId=b.popInt16(),c.data=b.popRestBuffer(),void 0!=this.remoteMeConfig.onUserMessage&&this.remoteMeConfig.onUserMessage(c.senderDeviceId,c.data);else if(c.typeId==MessageType.USER_SYNC_MESSAGE){if(c.size=b.popInt16(),c.receiveDeviceId=b.popInt16(),c.senderDeviceId=b.popInt16(),c.messageId=b.popInt64(),c.data=b.popRestBuffer(),void 0!=this.remoteMeConfig.onUserSyncMessage){var d=this.remoteMeConfig.onUserSyncMessage(c.senderDeviceId,c.data),f=getUserSyncResponseMessage(c.messageId,d);this.isWebSocketConnected()?this.sendWebSocket(f):this.sendRest(f)}else console.error("Sync message came but no function to handle it");}else if(c.typeId==MessageType.SYNC_MESSAGE_RESPONSE){c.size=b.popInt16(),c.messageId=b.popInt64(),c.data=b.popRestBuffer();var g=a.thiz.messageUserSyncIdToFunction[c.messageId];void 0==g?console.error("got reponse message but message id "+c.messageId+" was not recongized"):(g(c.data),a.thiz.messageUserSyncIdToFunction[c.messageId]=void 0)}else if(c.typeId==MessageType.VARIABLE_CHANGE_PROPAGATE_MESSAGE)this.getVariables()._onObserverPropagateMesage(b);else if(0==c.typeId);else console.error("Message id "+c.typeId+" was not reconized")}},{key:"isWebRTCConnected",value:function isWebRTCConnected(){return void 0==this.peerConnection||void 0==this.openedChanel?!1:"connected"==this.peerConnection.iceConnectionState}},{key:"restartWebRTC",value:function restartWebRTC(){this.disconnectWebRTC(),this.connectWebRTC()}},{key:"onWebrtcChange",value:function onWebrtcChange(b){void 0!=raspberryPiDeviceId&&(this.remoteMeConfig.webRTCConnectionChange&&this.remoteMeConfig.webRTCConnectionChange(b),this.sendWebRTCConnectionStatusChangeMessage(thisDeviceId,raspberryPiDeviceId,b))}},{key:"connectWebRTC",value:function connectWebRTC(){if(!this.isWebSocketConnected())return void console.error("websocket is not connected cannot create webrtc connection");this.onWebrtcChange(WebrtcConnectingStatusEnum.CONNECTING);var b={cmd:"register",targetDeviceId:raspberryPiDeviceId},c=JSON.stringify(b);this.sendWebSocketText(c)}},{key:"doSend",value:function doSend(b){var c={cmd:"send",msg:b,error:"",targetDeviceId:raspberryPiDeviceId},d=JSON.stringify(c);return!1!=a.thiz.sendWebSocketText(d)||(a.thiz.log("Failed to send data: "+d),!1)}},{key:"disconnectWebRTC",value:function disconnectWebRTC(){if(!this.isWebRTCConnected())return void console.info("webrtc is not connected cannot disconnect  webrtc connection");this.onWebrtcChange(WebrtcConnectingStatusEnum.DISCONNECTING);var b={cmd:"disconnect",msg:"",error:"",targetDeviceId:raspberryPiDeviceId},c=JSON.stringify(b);return!1==this.sendWebSocketText(c)?(this.log("Failed to send data: "+c),!1):void(this.openedChanel=void 0)}},{key:"createPeerConnection",value:function createPeerConnection(){this.peerConnection=new RTCPeerConnection(this.remoteMeConfig.pcConfig,this.remoteMeConfig.pcOptions),this.peerConnection.oniceconnectionstatechange=function(){"disconnected"==a.thiz.peerConnection.iceConnectionState?a.thiz.onWebrtcChange(WebrtcConnectingStatusEnum.DISCONNECTED):"failed"==a.thiz.peerConnection.iceConnectionState?a.thiz.onWebrtcChange(WebrtcConnectingStatusEnum.FAILED):"connected"==a.thiz.peerConnection.iceConnectionState?a.thiz.onWebrtcChange(WebrtcConnectingStatusEnum.CONNECTED):"checking"==a.thiz.peerConnection.iceConnectionState&&a.thiz.onWebrtcChange(WebrtcConnectingStatusEnum.CHECKING),a.thiz.log("webrtc connection status changed"+a.thiz.peerConnection.iceConnectionState)},this.peerConnection.onicecandidate=function(b){if(b.candidate){var c={type:"candidate",label:b.candidate.sdpMLineIndex,id:b.candidate.sdpMid,candidate:b.candidate.candidate};a.thiz.doSend(JSON.stringify(c))}else a.thiz.logTrace("End of candidates.")},this.peerConnection.onconnecting=this.onSessionConnecting,this.peerConnection.onopen=this.onSessionOpened,this.peerConnection.ontrack=this.onRemoteStreamAdded,this.peerConnection.onremovestream=this.onRemoteStreamRemoved,this.peerConnection.ondatachannel=this.onDataChannel,this.logTrace("Created RTCPeerConnnection with config: "+JSON.stringify(this.remoteMeConfig.pcConfig))}},{key:"onDataChannel",value:function onDataChannel(b){a.thiz.openedChanel=b.channel,a.thiz.openedChanel.binaryType="arraybuffer",a.thiz.logTrace("on data channel  "+b.channel.label),b.channel.onmessage=function(c){this.log("on Message by webrtc"+c),this.processIncommingBinnaryMessage(c.data)}.bind(a.thiz)}},{key:"onRemoteStreamAdded",value:function onRemoteStreamAdded(b){a.thiz.logTrace("Remote stream added:",b.streams);document.getElementById("remoteVideo");remoteVideo.srcObject=b.streams[0]}},{key:"sld_success_cb",value:function sld_success_cb(){a.thiz.logTrace("setLocalDescription success")}},{key:"sld_failure_cb",value:function sld_failure_cb(){a.thiz.logTrace("setLocalDescription failed")}},{key:"aic_success_cb",value:function aic_success_cb(){a.thiz.logTrace("addIceCandidate success")}},{key:"aic_failure_cb",value:function aic_failure_cb(b){a.thiz.logTrace("addIceCandidate failed",b)}},{key:"doHandlePeerMessage",value:function doHandlePeerMessage(b){++this.messageCounter;var c=JSON.parse(b);if(this.logTrace("Handle Message :",JSON.stringify(c)),"offer"==c.type){this.logTrace("Offer from PeerConnection");var d=this.forceChosenVideoCodec(c.sdp,"H264/90000");c.sdp=d,this.createPeerConnection(),this.peerConnection.setRemoteDescription(new RTCSessionDescription(c),this.onRemoteSdpSucces,this.onRemoteSdpError),this.peerConnection.createAnswer(function(g){a.thiz.logTrace("Create answer:",g),a.thiz.peerConnection.setLocalDescription(g,a.thiz.sld_success_cb,a.thiz.sld_failure_cb);var h=JSON.stringify(g);a.thiz.logTrace("Sending Answer: "+h),a.thiz.doSend(h)},function(g){this.logTrace("Create answer error:",g)},this.remoteMeConfig.mediaConstraints)}else if("candidate"==c.type){this.logTrace("Adding ICE candiate "+c.candidate);var f=new RTCIceCandidate({sdpMLineIndex:c.label,candidate:c.candidate});this.peerConnection.addIceCandidate(f,this.aic_success_cb,this.aic_failure_cb)}}},{key:"onSessionConnecting",value:function onSessionConnecting(){this.logTrace("Session connecting.")}},{key:"onSessionOpened",value:function onSessionOpened(){this.logTrace("Session opened.")}},{key:"onRemoteStreamRemoved",value:function onRemoteStreamRemoved(){this.logTrace("Remote stream removed.")}},{key:"onRemoteSdpError",value:function onRemoteSdpError(b){console.error("onRemoteSdpError",b.name,b.message),remoteMeConfig.webRTCConnectionChange&&remoteMeConfig.webRTCConnectionChange(!1)}},{key:"onRemoteSdpSucces",value:function onRemoteSdpSucces(){a.thiz.logTrace("onRemoteSdpSucces")}},{key:"forceChosenVideoCodec",value:function forceChosenVideoCodec(b,c){return this.maybePreferCodec(b,"video","send",c)}},{key:"forceChosenAudioCodec",value:function forceChosenAudioCodec(b,c){return this.maybePreferCodec(b,"audio","send",c)}},{key:"maybePreferCodec",value:function maybePreferCodec(b,c,d,f){var g=c+" "+d+" codec";if(""===f)return this.logTrace("No preference on "+g+"."),b;this.logTrace("Prefer "+g+": "+f);var h=b.split("\r\n"),j=this.findLine(h,"m=",c);if(null===j)return this.logTrace("* not found error: "+g+": "+f),b;var l=this.findLine(h,"a=rtpmap",f);if(this.logTrace("mLineIndex Line: "+h[j]),this.logTrace("found Prefered Codec in : "+l+": "+h[l]),this.logTrace("codecIndex",l),l){var m=this.getCodecPayloadType(h[l]);m&&(h[j]=this.setDefaultCodec(h[j],m))}return this.logTrace("** Modified LineIndex Line: "+h[j]),b=h.join("\r\n"),b}},{key:"findLine",value:function findLine(b,c,d){return this.findLineInRange(b,0,-1,c,d)}},{key:"findLineInRange",value:function findLineInRange(b,c,d,f,g){for(var h=-1===d?b.length:d,j=c;j<h;++j)if(0===b[j].indexOf(f)&&(!g||-1!==b[j].toLowerCase().indexOf(g.toLowerCase())))return j;return null}},{key:"getCodecPayloadType",value:function getCodecPayloadType(b){var c=/a=rtpmap:(\d+) \w+\/\d+/,d=b.match(c);return d&&2===d.length?d[1]:null}},{key:"setDefaultCodec",value:function setDefaultCodec(b,c){var d=b.split(" "),f=d.slice(0,3);f.push(c);for(var g=3;g<d.length;g++)d[g]!==c&&f.push(d[g]);return f.join(" ")}},{key:"setDefaultCodecAndRemoveOthers",value:function setDefaultCodecAndRemoveOthers(b,c,d){var f=c.split(" "),g=f.slice(0,3);g.push(d);for(var h=3;h<f.length;h++)if(f[h]!==d){for(var j=!0;j;)j=RemoveLineInRange(b,0,-1,"a=rtpmap",f[h]);for(var j=!0;j;)j=RemoveLineInRange(b,0,-1,"a=rtcp-fb",f[h])}return g.join(" ")}},{key:"RemoveLineInRange",value:function RemoveLineInRange(b,c,d,f,g){for(var h=-1===d?b.length:d,j=c;j<h;++j)if(0===b[j].indexOf(f)&&(!g||-1!==b[j].toLowerCase().indexOf(g.toLowerCase()))){var l="Deleting(index: "+j+") : "+b[j];return this.logTrace(l),b.splice(j,1),!0}return!1}},{key:"sendUserMessageByFasterChannel",value:function sendUserMessageByFasterChannel(b,c){0<=b?this.isDirectWebSocketConnectionConnected(b)?this.sendUserMessageDirectWebsocket(b,c):this.isWebRTCConnected()?this.sendUserMessageWebrtc(b,c):this.isWebSocketConnected()?this.sendUserMessageWebsocket(b,c):this.sendUserMessageRest(b,c):console.error("Cannot send message to deviceId with this id, did You configure your script correct ?")}},{key:"sendUserMessageWebsocket",value:function sendUserMessageWebsocket(b,c){this.sendWebSocket(getUserMessage(WSUserMessageSettings.NO_RENEWAL,b,thisDeviceId,0,c))}},{key:"sendUserMessageDirectWebsocket",value:function sendUserMessageDirectWebsocket(b,c){var d=getUserMessage(WSUserMessageSettings.NO_RENEWAL,b,thisDeviceId,0,c);sendDirectWebsocket(b,d)}},{key:"sendDirectWebsocket",value:function sendDirectWebsocket(b,c){return this.isDirectWebSocketConnectionConnected(b)?(this.directWebSocket[b].send(c),!0):(this.log("Directwebsocket is not opened"),!1)}},{key:"sendUserMessageWebrtc",value:function sendUserMessageWebrtc(b,c){this.sendWebRtc(getUserMessage(WSUserMessageSettings.NO_RENEWAL,b,thisDeviceId,0,c))}},{key:"sendUserMessageRest",value:function sendUserMessageRest(b,c){this.sendRest(getUserMessage(WSUserMessageSettings.NO_RENEWAL,b,thisDeviceId,0,c))}},{key:"sendUserSyncMessageRest",value:function sendUserSyncMessageRest(b,c,d){this.sendRestSync(getUserSyncMessage(b,thisDeviceId,c),d)}},{key:"isDirectWebSocketConnectionConnected",value:function isDirectWebSocketConnectionConnected(b){return void 0!=this.directWebSocket[b]&&this.directWebSocket[b].readyState===this.directWebSocket[b].OPEN}},{key:"directWebSocketConnectionDisconnect",value:function directWebSocketConnectionDisconnect(b){this.isDirectWebSocketConnectionConnected(b)&&this.directWebSocket[b].close(),this.directWebSocket[b]=void 0}},{key:"directWebSocketConnectionConnect",value:function directWebSocketConnectionConnect(b,c){var d=this;"http:"!=location.protocol&&(location.href="http:"+window.location.href.substring(window.location.protocol.length)),RemoteMeRest_getLocalWebSocketServer(b,function(f){d.directWebSocket[b]=new WebSocket("ws://"+f.localIP+":"+f.port),d.directWebSocket[b].binaryType="arraybuffer",d.directWebSocket[b].onmessage=d.onMessageWS.bind(d),void 0!=c&&(d.directWebSocket[b].onopen=function(){return c(b,WebsocketConnectingStatusEnum.CONNECTED)},d.directWebSocket[b].onerror=function(){return c(b,WebsocketConnectingStatusEnum.ERROR)},d.directWebSocket[b].onclose=function(){return c(b,WebsocketConnectingStatusEnum.DISCONNECTED)})},function(){void 0!=c&&c(b,WebsocketConnectingStatusEnum.ERROR),console.error("Cannot connect local webserver, check if tis enabled at Your arduino")})}}]),a}();
    </script>

    <!--<script src="https://remoteme.org/public/libs/remoteme/variables.js"></script>-->
    <script type="text/javascript">
        "use strict";var _createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var ToSend=function(){function a(){_classCallCheck(this,a),this.type=0,this.name="",this.values=[]}return _createClass(a,[{key:"getSize",value:function getSize(){var b=2+this.name.length+1;switch(this.type){case VariableOberverType.BOOLEAN:b+=1;break;case VariableOberverType.INTEGER:b+=4;break;case VariableOberverType.TEXT:b+=getArray(this.values[0]).length+1;break;case VariableOberverType.SMALL_INTEGER_3:b+=6;break;case VariableOberverType.SMALL_INTEGER_2:b+=4;break;case VariableOberverType.INTEGER_BOOLEAN:b+=5;break;case VariableOberverType.DOUBLE:b+=8;break;case VariableOberverType.TEXT_2:b+=getArray(this.values[0]).length+1+getArray(this.values[1]).length+1;}return b}},{key:"serialize",value:function serialize(b){switch(b.putShort(this.type),b.putString(this.name),this.type){case VariableOberverType.BOOLEAN:b.putByte(this.values[0]?1:0);break;case VariableOberverType.INTEGER:b.putInt32(this.values[0]);break;case VariableOberverType.TEXT:b.putString(this.values[0]);break;case VariableOberverType.SMALL_INTEGER_3:b.putInt16(this.values[0]),b.putInt16(this.values[1]),b.putInt16(this.values[2]);break;case VariableOberverType.SMALL_INTEGER_2:b.putInt16(this.values[0]),b.putInt16(this.values[1]);break;case VariableOberverType.INTEGER_BOOLEAN:b.putInt32(this.values[0]),b.putByte(this.values[1]?1:0);break;case VariableOberverType.DOUBLE:b.putDouble(this.values[0]);break;case VariableOberverType.TEXT_2:b.putString(this.values[0]),b.putString(this.values[1]);}}}]),a}(),Variables=function(){function a(b){_classCallCheck(this,a),this.remoteMe=b,this.observables=[],this.sendNow=!0,this.toSend=[]}return _createClass(a,[{key:"begin",value:function begin(){this.sendNow=!1}},{key:"commit",value:function commit(){0<this.toSend.length&&this._sendNow(),this.sendNow=!0}}]),_createClass(a,[{key:"_onObserverPropagateMesage",value:function _onObserverPropagateMesage(b){b.popInt16();for(var c=b.popInt16(),d=b.popInt16(),e=b.popInt16(),f=0;f<e;f++){var g=b.popUint16(),h=b.popString(),k=this.observables[h+g];if(void 0!=k){var l,m,n;g==VariableOberverType.BOOLEAN?l=1==b.popByte():g==VariableOberverType.INTEGER?l=b.popInt32():g==VariableOberverType.INTEGER_BOOLEAN?(l=b.popInt32(),m=1==b.popByte()):g==VariableOberverType.SMALL_INTEGER_2?(l=b.popInt16(),m=b.popInt16()):g==VariableOberverType.SMALL_INTEGER_3?(l=b.popInt16(),m=b.popInt16(),n=b.popInt16()):g==VariableOberverType.DOUBLE?l=b.popDouble():g==VariableOberverType.TEXT?l=b.popString():g==VariableOberverType.TEXT_2?(l=b.popString(),m=b.popString()):console.warn(" variable type didnt found if u think its bug contact me contact@remoteme.org");for(var o=0;o<k.length;o++)k[o](l,m,n)}else console.warn("ddint found observer with name "+h+" and type"+g)}}},{key:"setBoolean",value:function setBoolean(b,c){this.set(b,VariableOberverType.BOOLEAN,[c])}},{key:"setInteger",value:function setInteger(b,c){this.set(b,VariableOberverType.INTEGER,[c])}},{key:"setText",value:function setText(b,c){this.set(b,VariableOberverType.TEXT,[c])}},{key:"setSmallInteger3",value:function setSmallInteger3(b,c,d,e){this.set(b,VariableOberverType.SMALL_INTEGER_3,[c,d,e])}},{key:"setSmallInteger2",value:function setSmallInteger2(b,c,d){this.set(b,VariableOberverType.SMALL_INTEGER_2,[c,d])}},{key:"setIntegerBoolean",value:function setIntegerBoolean(b,c,d){this.set(b,VariableOberverType.INTEGER_BOOLEAN,[c,d])}},{key:"setDouble",value:function setDouble(b,c){this.set(b,VariableOberverType.DOUBLE,[c])}},{key:"setText2",value:function setText2(b,c,d){this.set(b,VariableOberverType.TEXT_2,[c,d])}},{key:"set",value:function set(b,c,d){var e=new ToSend;e.name=b,e.type=c,e.values=d,this.toSend.push(e),this.sendNow&&this._sendNow()}},{key:"_sendNow",value:function _sendNow(){var b=[],c=5+2*b.length,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var h,d,g=this.toSend[Symbol.iterator]();!(_iteratorNormalCompletion=(h=g.next()).done);_iteratorNormalCompletion=!0)d=h.value,c+=current.getSize()}catch(q){_didIteratorError=!0,_iteratorError=q}finally{try{!_iteratorNormalCompletion&&g.return&&g.return()}finally{if(_didIteratorError)throw _iteratorError}}var e=new RemoteMeData(4+c);e.putShort(MessageType.VARIABLE_CHANGE_MESSAGE),e.putShort(c),e.putShort(thisDeviceId),e.putByte(b.length);var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var l,d,k=b[Symbol.iterator]();!(_iteratorNormalCompletion2=(l=k.next()).done);_iteratorNormalCompletion2=!0)d=l.value,e.putShort(current)}catch(q){_didIteratorError2=!0,_iteratorError2=q}finally{try{!_iteratorNormalCompletion2&&k.return&&k.return()}finally{if(_didIteratorError2)throw _iteratorError2}}e.putShort(this.toSend.length);var _iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var n,d,m=this.toSend[Symbol.iterator]();!(_iteratorNormalCompletion3=(n=m.next()).done);_iteratorNormalCompletion3=!0)d=n.value,d.serialize(e)}catch(q){_didIteratorError3=!0,_iteratorError3=q}finally{try{!_iteratorNormalCompletion3&&m.return&&m.return()}finally{if(_didIteratorError3)throw _iteratorError3}}var _iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var p,f,o=Object.keys(this.remoteMe.directWebSocket)[Symbol.iterator]();!(_iteratorNormalCompletion4=(p=o.next()).done);_iteratorNormalCompletion4=!0)f=p.value,this.remoteMe.sendDirectWebsocket(f,e)}catch(q){_didIteratorError4=!0,_iteratorError4=q}finally{try{!_iteratorNormalCompletion4&&o.return&&o.return()}finally{if(_didIteratorError4)throw _iteratorError4}}this.remoteMe.isWebRTCConnected()&&this.remoteMe.sendWebRtc(e),this.remoteMe.isWebSocketConnected()?this.remoteMe.sendWebSocket(e):this.remoteMe.sendRest(e),this.toSend=[]}},{key:"observeBoolean",value:function observeBoolean(b,c){this.observe(b,VariableOberverType.BOOLEAN,c)}},{key:"observeInteger",value:function observeInteger(b,c){this.observe(b,VariableOberverType.INTEGER,c)}},{key:"observeText",value:function observeText(b,c){this.observe(b,VariableOberverType.TEXT,c)}},{key:"observeSmallInteger3",value:function observeSmallInteger3(b,c){this.observe(b,VariableOberverType.SMALL_INTEGER_3,c)}},{key:"observeSmallInteger2",value:function observeSmallInteger2(b,c){this.observe(b,VariableOberverType.SMALL_INTEGER_2,c)}},{key:"observeIntegerBoolean",value:function observeIntegerBoolean(b,c){this.observe(b,VariableOberverType.INTEGER_BOOLEAN,c)}},{key:"observeDouble",value:function observeDouble(b,c){this.observe(b,VariableOberverType.DOUBLE,c)}},{key:"observeText2",value:function observeText2(b,c){this.observe(b,VariableOberverType.TEXT_2,c)}},{key:"observe",value:function observe(b,c,d){var e=6+b.length+1,f=new RemoteMeData(4+e);f.putShort(MessageType.OBSERVER_REGISTER_MESSAGE),f.putShort(e),f.putShort(thisDeviceId),f.putShort(1),f.putShort(c),f.putString(b),this.remoteMe.isWebSocketConnected()?this.remoteMe.sendWebSocket(f):this.remoteMe.sendRest(f),void 0==this.observables[b+c]&&(this.observables[b+c]=[]),this.observables[b+c].push(d)}}]),a}();
    </script>

    <!--    <script src="https://remoteme.org/public/libs/remoteme/remoteMeApiRest.js"></script>-->
    <script type="text/javascript">
        "use strict";function RemoteMeRest_getLocalWebSocketServer(a,b,c){RemoteMeRest_callRest("/api/rest/v1/device/localWebSocketServer/"+a+"/","GET",function(d){b(d)},function(d){c(d)})}function RemoteMeRest_callRest(a,b,c,d){$.ajax({type:b,dataType:"json",url:a,success:function success(e){c(e)},error:function error(e){console.error("error while calling rest : "+a+" status:"+e.status),d(e.statusText)}})}
    </script>

    <!--    <script src="https://remoteme.org/public/libs/remoteme/remoteMeMessages.js"></script>-->
    <script type="text/javascript">
        "use strict";var _createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}VariableOberverType={BOOLEAN:0,INTEGER:1,TEXT:2,SMALL_INTEGER_3:3,SMALL_INTEGER_2:4,INTEGER_BOOLEAN:5,DOUBLE:6,TEXT_2:7},ChangeMessageSetting={NO_RENEWAL:0,RENEWAL_IF_FAILED:1},MessageType={USER_MESSAGE:100,CHANGE_MESSAGE:103,USER_MESSAGE_DELIVER_STATUS:101,USER_SYNC_MESSAGE:102,VARIABLE_CHANGE_MESSAGE:103,VARIABLE_CHANGE_PROPAGATE_MESSAGE:104,SYNC_MESSAGE:120,SYNC_MESSAGE_RESPONSE:121,OBSERVER_REGISTER_MESSAGE:122,REGISTER_DEVICE:200,REGISTER_CHILD_DEVICE:201,ADD_DATA:300,LOG:2e4,SYSTEM_MESSAGE:20001,WEB_RTC_CONNECTION_CHANGE:20002},WSUserMessageSettings={NO_RENEWAL:0,RENEWAL_IF_FAILED:1},AddDataMessageSetting={NO_ROUND:0,_1S:1,_2S:2,_5S:3,_10S:4,_15S:5,_20S:6,_30S:7},DeviceType={NETWORK:1,SMARTPHONE:2,WEBPAGE:3,JSSCRIPT:4},LogLevel={INFO:1,WARN:2,ERROR:3},LeafDeviceType={LD_OTHER:1,LD_EXTERNAL_SCRIPT:2,LD_SERIAL:3,LD_NRF24:4,LD_WEB_SOCKET:5},SyncMessageType={USER:0,GET_WEBRTC_CONENCTED_DEVICE_ID:1},AndroidMessageIcon={DEFAULT_ICON:1,PERSON_ICON:2,THIEF_ICON:3,WINDOW_OPEN_ICON:4,BUNNY_ICON:5},AndroidMessageSound={DEFAULT_SOUND:1};var RemoteMeData=function(){function a(b){_classCallCheck(this,a),this.dataView=getDataView(b),this.pos=0}return _createClass(a,[{key:"popFloat32",value:function popFloat32(){var b=this.dataView.getFloat32(this.pos);return this.pos+=4,b}},{key:"popFloat64",value:function popFloat64(){var b=this.dataView.getFloat64(this.pos);return this.pos+=8,b}},{key:"popDouble",value:function popDouble(){return this.popFloat64()}},{key:"popInt8",value:function popInt8(){var b=this.dataView.getInt8(this.pos);return this.pos+=1,b}},{key:"popByte",value:function popByte(){return this.popInt8()}},{key:"popInt16",value:function popInt16(){var b=this.dataView.getInt16(this.pos);return this.pos+=2,b}},{key:"popInt32",value:function popInt32(){var b=this.dataView.getInt32(this.pos);return this.pos+=4,b}},{key:"popInt64",value:function popInt64(){return this.popInt32()*Math.pow(2,32)+this.popInt32()}},{key:"popUint8",value:function popUint8(){var b=this.dataView.getUint8(this.pos);return this.pos+=1,b}},{key:"popUint16",value:function popUint16(){var b=this.dataView.getUint16(this.pos);return this.pos+=2,b}},{key:"popString",value:function popString(){var b=[];do b.push(this.popByte());while(0!=b[b.length-1]);return b.pop(),byteArrayToString(new Uint8Array(b))}},{key:"popUint32",value:function popUint32(){var b=this.dataView.getUint32(this.pos);return this.pos+=4,b}},{key:"popArray",value:function popArray(b){var c=new Uint8Array(this.dataView.buffer,this.pos,b);return this.pos+=b,_getArray(getDataView(c).buffer)}},{key:"popRestBuffer",value:function popRestBuffer(){var b=new Uint8Array(this.dataView.buffer,this.pos);return this.pos=this.size(),getDataView(b).buffer}},{key:"putFloat32",value:function putFloat32(b){this.dataView.setFloat32(this.pos,b),this.pos+=4}},{key:"putFloat64",value:function putFloat64(b){this.dataView.setFloat64(this.pos,b),this.pos+=8}},{key:"putDouble",value:function putDouble(b){this.putFloat64(b)}},{key:"putInt8",value:function putInt8(b){this.dataView.setInt8(this.pos,b),this.pos+=1}},{key:"putByte",value:function putByte(b){this.putInt8(b)}},{key:"putInt16",value:function putInt16(b){this.dataView.setInt16(this.pos,b),this.pos+=2}},{key:"putShort",value:function putShort(b){this.putInt16(b)}},{key:"putInt32",value:function putInt32(b){this.dataView.setInt32(this.pos,b),this.pos+=4}},{key:"putUint8",value:function putUint8(b){this.dataView.setUint8(this.pos,b),this.pos+=1}},{key:"putUint16",value:function putUint16(b){this.dataView.setUint16(this.pos,b),this.pos+=2}},{key:"putUint32",value:function putUint32(b){this.dataView.setUint32(this.pos,b),this.pos+=4}},{key:"putLong",value:function putLong(b){for(var e,c=[],d=0;8>d;d++)e=255&b,c[8-d-1]=e,b=(b-e)/256;this.putArray(c)}},{key:"putArray",value:function putArray(b){var c=this;_getArray(b).forEach(function(d){return c.dataView.setInt8(c.pos++,d)})}},{key:"putString",value:function putString(b){this.putArray(_getArray(b)),this.putInt8(0)}},{key:"getBufferArray",value:function getBufferArray(){return this.dataView.buffer}},{key:"getArray",value:function getArray(){return _getArray(this)}},{key:"print",value:function print(){console.info(toHexString(new Uint8Array(this.getBufferArray())))}},{key:"size",value:function size(){return this.dataView.byteLength}},{key:"rewind",value:function rewind(){this.pos=0}}]),a}();function _getArray(a){return("string"==typeof a||a instanceof String)&&(a=stringToByteArray(a)),a instanceof RemoteMeData&&(a=new(Function.prototype.bind.apply(Array,[null].concat(_toConsumableArray(new Uint8Array(a.dataView.buffer)))))),a instanceof ArrayBuffer&&(a=new(Function.prototype.bind.apply(Array,[null].concat(_toConsumableArray(new Uint8Array(a)))))),a instanceof Uint8Array&&(a=new(Function.prototype.bind.apply(Array,[null].concat(_toConsumableArray(a))))),a}function getDataView(a){var b;return a instanceof Uint8Array||a instanceof Array?(b=new DataView(new ArrayBuffer(a.length)),a.map(function(c,d){b.setUint8(d,c)})):isNaN(a)?b=new DataView(a):b=new DataView(new ArrayBuffer(a)),b}function getUserMessage(a,b,c,d,e){e=_getArray(e),size=7+e.length;var f=new RemoteMeData(4+size);return f.putShort(MessageType.USER_MESSAGE),f.putShort(size),f.putByte(a),f.putShort(b),f.putShort(c),f.putShort(d),f.putArray(e),f.getBufferArray()}function getWebRTCConnectionStatusChangeMessage(a,b,c){size=5;var d=new RemoteMeData(4+size);return d.putShort(MessageType.WEB_RTC_CONNECTION_CHANGE),d.putShort(size),d.putByte(c),d.putShort(a),d.putShort(b),d.getBufferArray()}function getSyncMessage(a,b,c,d){c=_getArray(c),size=12+c.length;var e=new RemoteMeData(4+size);return e.putShort(MessageType.USER_SYNC_MESSAGE),e.putShort(size),e.putShort(a),e.putShort(b),e.putLong(d),e.putArray(c),e.getBufferArray()}function getUserSyncMessage(a,b,c,d){c=_getArray(c),size=12+c.length;var e=new RemoteMeData(4+size);return e.putShort(MessageType.USER_SYNC_MESSAGE),e.putShort(size),e.putShort(a),e.putShort(b),e.putLong(d),e.putArray(c),e.getBufferArray()}function getUserSyncResponseMessage(a,b){b=_getArray(b),size=8+b.length;var c=new RemoteMeData(4+size);return c.putShort(MessageType.SYNC_MESSAGE_RESPONSE),c.putShort(size),c.putLong(a),c.putArray(b),c.getBufferArray()}function getLogMessage(a,b){b=_getArray(b),size=2+b.length,pos=0;var c=new RemoteMeData(4+size);return c.putShort(pos,MessageType.LOG),c.putShort(pos,size),c.putByte(pos,a),c.putString(pos,b),c}function getAndroidMessage(a,b,c,d,e,f){size=stringToByteArray(b).length+1,size+=stringToByteArray(c).length+1,size+=3,size+=2;var g=new RemoteMeData(size);return g.putString(b),g.putString(c),g.putArray(parseHexString(d.substring(1))),g.putByte(e),g.putByte(f),getUserMessage(WSUserMessageSettings.NO_RENEWAL,a,0,g)}function getAddDataMessage(a,b,c){size=9+10*c.size();var d=new RemoteMeData(size+4);for(d.putShort(MessageType.ADD_DATA),d.putShort(size),d.putLong(a),d.putByte(b),i=0;i<c.length;i++){var e=c[i];d.putShort(e[0]),d.putDouble(e[1])}return d.getBufferArray()}function stringToByteArray(a){return Array.from(new TextEncoder("utf-8").encode(a))}function byteArrayToString(a){return new TextDecoder("utf-8").decode(a)}function toHexString(a){return Array.from(a,function(b){return("0"+(255&b).toString(16)).slice(-2)}).join(" ")}function parseHexString(a){var b=[];for(i=0;i<a.length;i+=2)b.push(parseInt(a.substring(i,i+2),16));return b}
    </script>

    <!--<script src="https://remoteme.org/public/libs/remoteme/adapter.js"></script>-->
    <script type="text/javascript">
        "use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"==typeof Symbol&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m};(function(m){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=m();else if("function"==typeof define&&define.amd)define([],m);else{var h;h="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,h.adapter=m()}})(function(){return function C(y,T,S){function R(E,_){if(!T[E]){if(!y[E]){var x="function"==typeof require&&require;if(!_&&x)return x(E,!0);if(P)return P(E,!0);var L=new Error("Cannot find module '"+E+"'");throw L.code="MODULE_NOT_FOUND",L}var M=T[E]={exports:{}};y[E][0].call(M.exports,function(I){var w=y[E][1][I];return R(w?w:I)},M,M.exports,C,y,T,S)}return T[E].exports}for(var P="function"==typeof require&&require,k=0;k<S.length;k++)R(S[k]);return R}({1:[function(C,y){"use strict";function S(w,D,O,U,G){var A=I.writeRtpDescription(w.kind,D);if(A+=I.writeIceParameters(w.iceGatherer.getLocalParameters()),A+=I.writeDtlsParameters(w.dtlsTransport.getLocalParameters(),"offer"===O?"actpass":G||"active"),A+="a=mid:"+w.mid+"\r\n",A+=w.rtpSender&&w.rtpReceiver?"a=sendrecv\r\n":w.rtpSender?"a=sendonly\r\n":w.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",w.rtpSender){var N="msid:"+U.id+" "+w.rtpSender.track.id+"\r\n";A+="a="+N,A+="a=ssrc:"+w.sendEncodingParameters[0].ssrc+" "+N,w.sendEncodingParameters[0].rtx&&(A+="a=ssrc:"+w.sendEncodingParameters[0].rtx.ssrc+" "+N,A+="a=ssrc-group:FID "+w.sendEncodingParameters[0].ssrc+" "+w.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return A+="a=ssrc:"+w.sendEncodingParameters[0].ssrc+" cname:"+I.localCName+"\r\n",w.rtpSender&&w.sendEncodingParameters[0].rtx&&(A+="a=ssrc:"+w.sendEncodingParameters[0].rtx.ssrc+" cname:"+I.localCName+"\r\n"),A}function R(w,D){var O=!1;return w=JSON.parse(JSON.stringify(w)),w.filter(function(U){if(U&&(U.urls||U.url)){var G=U.urls||U.url;U.url&&!U.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var A="string"==typeof G;return A&&(G=[G]),G=G.filter(function(N){var F=0===N.indexOf("turn:")&&-1!==N.indexOf("transport=udp")&&-1===N.indexOf("turn:[")&&!O;return F?(O=!0,!0):0===N.indexOf("stun:")&&14393<=D&&-1===N.indexOf("?transport=udp")}),delete U.url,U.urls=A?G[0]:G,!!G.length}})}function P(w,D){var O={codecs:[],headerExtensions:[],fecMechanisms:[]},U=function(A,N){A=parseInt(A,10);for(var F=0;F<N.length;F++)if(N[F].payloadType===A||N[F].preferredPayloadType===A)return N[F]},G=function(A,N,F,z){var B=U(A.parameters.apt,F),V=U(N.parameters.apt,z);return B&&V&&B.name.toLowerCase()===V.name.toLowerCase()};return w.codecs.forEach(function(A){for(var F,N=0;N<D.codecs.length;N++)if(F=D.codecs[N],A.name.toLowerCase()===F.name.toLowerCase()&&A.clockRate===F.clockRate){if("rtx"===A.name.toLowerCase()&&A.parameters&&F.parameters.apt&&!G(A,F,w.codecs,D.codecs))continue;F=JSON.parse(JSON.stringify(F)),F.numChannels=Math.min(A.numChannels,F.numChannels),O.codecs.push(F),F.rtcpFeedback=F.rtcpFeedback.filter(function(z){for(var B=0;B<A.rtcpFeedback.length;B++)if(A.rtcpFeedback[B].type===z.type&&A.rtcpFeedback[B].parameter===z.parameter)return!0;return!1});break}}),w.headerExtensions.forEach(function(A){for(var F,N=0;N<D.headerExtensions.length;N++)if(F=D.headerExtensions[N],A.uri===F.uri){O.headerExtensions.push(F);break}}),O}function k(w,D,O){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[D][w].indexOf(O)}function E(w,D){var O=w.getRemoteCandidates().find(function(U){return D.foundation===U.foundation&&D.ip===U.ip&&D.port===U.port&&D.priority===U.priority&&D.protocol===U.protocol&&D.type===U.type});return O||w.addRemoteCandidate(D),!O}function _(w,D){D.addTrack(w);var O=new Event("addtrack");O.track=w,D.dispatchEvent(O)}function x(w,D){D.removeTrack(w);var O=new Event("removetrack");O.track=w,D.dispatchEvent(O)}function L(w,D,O,U){var G=new Event("track");G.track=D,G.receiver=O,G.transceiver={receiver:O},G.streams=U,window.setTimeout(function(){w._dispatchEvent("track",G)})}function M(w,D){var O=new Error(D);return O.name=w,O}var I=C("sdp");y.exports=function(w,D){var O=function(G){var A=this,N=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(z){A[z]=N[z].bind(N)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this.localDescription=null,this.remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",G=JSON.parse(JSON.stringify(G||{})),this.usingBundle="max-bundle"===G.bundlePolicy,"negotiate"===G.rtcpMuxPolicy)throw M("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");else G.rtcpMuxPolicy||(G.rtcpMuxPolicy="require");switch(G.iceTransportPolicy){case"all":case"relay":break;default:G.iceTransportPolicy="all";}switch(G.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:G.bundlePolicy="balanced";}if(G.iceServers=R(G.iceServers||[],D),this._iceGatherers=[],G.iceCandidatePoolSize)for(var F=G.iceCandidatePoolSize;0<F;F--)this._iceGatherers=new w.RTCIceGatherer({iceServers:G.iceServers,gatherPolicy:G.iceTransportPolicy});else G.iceCandidatePoolSize=0;this._config=G,this.transceivers=[],this._sdpSessionId=I.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};O.prototype.onicecandidate=null,O.prototype.onaddstream=null,O.prototype.ontrack=null,O.prototype.onremovestream=null,O.prototype.onsignalingstatechange=null,O.prototype.oniceconnectionstatechange=null,O.prototype.onicegatheringstatechange=null,O.prototype.onnegotiationneeded=null,O.prototype.ondatachannel=null,O.prototype._dispatchEvent=function(G,A){this._isClosed||(this.dispatchEvent(A),"function"==typeof this["on"+G]&&this["on"+G](A))},O.prototype._emitGatheringStateChange=function(){var G=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",G)},O.prototype.getConfiguration=function(){return this._config},O.prototype.getLocalStreams=function(){return this.localStreams},O.prototype.getRemoteStreams=function(){return this.remoteStreams},O.prototype._createTransceiver=function(G){var A=0<this.transceivers.length,N={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:G,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&A)N.iceTransport=this.transceivers[0].iceTransport,N.dtlsTransport=this.transceivers[0].dtlsTransport;else{var F=this._createIceAndDtlsTransports();N.iceTransport=F.iceTransport,N.dtlsTransport=F.dtlsTransport}return this.transceivers.push(N),N},O.prototype.addTrack=function(G,A){var N=this.transceivers.find(function(B){return B.track===G});if(N)throw M("InvalidAccessError","Track already exists.");if("closed"===this.signalingState)throw M("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");for(var F,z=0;z<this.transceivers.length;z++)this.transceivers[z].track||this.transceivers[z].kind!==G.kind||(F=this.transceivers[z]);return F||(F=this._createTransceiver(G.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(A)&&this.localStreams.push(A),F.track=G,F.stream=A,F.rtpSender=new w.RTCRtpSender(G,F.dtlsTransport),F.rtpSender},O.prototype.addStream=function(G){var A=this;if(15025<=D)G.getTracks().forEach(function(F){A.addTrack(F,G)});else{var N=G.clone();G.getTracks().forEach(function(F,z){var B=N.getTracks()[z];F.addEventListener("enabled",function(V){B.enabled=V.enabled})}),N.getTracks().forEach(function(F){A.addTrack(F,N)})}},O.prototype.removeTrack=function(G){if(!(G instanceof w.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var A=this.transceivers.find(function(z){return z.rtpSender===G});if(!A)throw M("InvalidAccessError","Sender was not created by this connection.");var N=A.stream;A.rtpSender.stop(),A.rtpSender=null,A.track=null,A.stream=null;var F=this.transceivers.map(function(z){return z.stream});-1===F.indexOf(N)&&-1<this.localStreams.indexOf(N)&&this.localStreams.splice(this.localStreams.indexOf(N),1),this._maybeFireNegotiationNeeded()},O.prototype.removeStream=function(G){var A=this;G.getTracks().forEach(function(N){var F=A.getSenders().find(function(z){return z.track===N});F&&A.removeTrack(F)})},O.prototype.getSenders=function(){return this.transceivers.filter(function(G){return!!G.rtpSender}).map(function(G){return G.rtpSender})},O.prototype.getReceivers=function(){return this.transceivers.filter(function(G){return!!G.rtpReceiver}).map(function(G){return G.rtpReceiver})},O.prototype._createIceGatherer=function(G,A){var N=this;if(A&&0<G)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var F=new w.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(F,"state",{value:"new",writable:!0}),this.transceivers[G].candidates=[],this.transceivers[G].bufferCandidates=function(z){var B=!z.candidate||0===Object.keys(z.candidate).length;F.state=B?"completed":"gathering",null!==N.transceivers[G].candidates&&N.transceivers[G].candidates.push(z.candidate)},F.addEventListener("localcandidate",this.transceivers[G].bufferCandidates),F},O.prototype._gather=function(G,A){var N=this,F=this.transceivers[A].iceGatherer;if(!F.onlocalcandidate){var z=this.transceivers[A].candidates;this.transceivers[A].candidates=null,F.removeEventListener("localcandidate",this.transceivers[A].bufferCandidates),F.onlocalcandidate=function(B){if(!(N.usingBundle&&0<A)){var V=new Event("icecandidate");V.candidate={sdpMid:G,sdpMLineIndex:A};var H=B.candidate,W=!H||0===Object.keys(H).length;W?("new"===F.state||"gathering"===F.state)&&(F.state="completed"):("new"===F.state&&(F.state="gathering"),H.component=1,V.candidate.candidate=I.writeCandidate(H));var q=I.splitSections(N.localDescription.sdp);q[V.candidate.sdpMLineIndex+1]+=W?"a=end-of-candidates\r\n":"a="+V.candidate.candidate+"\r\n",N.localDescription.sdp=q.join("");var K=N.transceivers.every(function(J){return J.iceGatherer&&"completed"===J.iceGatherer.state});"gathering"!==N.iceGatheringState&&(N.iceGatheringState="gathering",N._emitGatheringStateChange()),W||N._dispatchEvent("icecandidate",V),K&&(N._dispatchEvent("icecandidate",new Event("icecandidate")),N.iceGatheringState="complete",N._emitGatheringStateChange())}},w.setTimeout(function(){z.forEach(function(B){var V=new Event("RTCIceGatherEvent");V.candidate=B,F.onlocalcandidate(V)})},0)}},O.prototype._createIceAndDtlsTransports=function(){var G=this,A=new w.RTCIceTransport(null);A.onicestatechange=function(){G._updateConnectionState()};var N=new w.RTCDtlsTransport(A);return N.ondtlsstatechange=function(){G._updateConnectionState()},N.onerror=function(){Object.defineProperty(N,"state",{value:"failed",writable:!0}),G._updateConnectionState()},{iceTransport:A,dtlsTransport:N}},O.prototype._disposeIceAndDtlsTransports=function(G){var A=this.transceivers[G].iceGatherer;A&&(delete A.onlocalcandidate,delete this.transceivers[G].iceGatherer);var N=this.transceivers[G].iceTransport;N&&(delete N.onicestatechange,delete this.transceivers[G].iceTransport);var F=this.transceivers[G].dtlsTransport;F&&(delete F.ondtlsstatechange,delete F.onerror,delete this.transceivers[G].dtlsTransport)},O.prototype._transceive=function(G,A,N){var F=P(G.localCapabilities,G.remoteCapabilities);A&&G.rtpSender&&(F.encodings=G.sendEncodingParameters,F.rtcp={cname:I.localCName,compound:G.rtcpParameters.compound},G.recvEncodingParameters.length&&(F.rtcp.ssrc=G.recvEncodingParameters[0].ssrc),G.rtpSender.send(F)),N&&G.rtpReceiver&&0<F.codecs.length&&("video"===G.kind&&G.recvEncodingParameters&&15019>D&&G.recvEncodingParameters.forEach(function(z){delete z.rtx}),G.recvEncodingParameters.length&&(F.encodings=G.recvEncodingParameters),F.rtcp={compound:G.rtcpParameters.compound},G.rtcpParameters.cname&&(F.rtcp.cname=G.rtcpParameters.cname),G.sendEncodingParameters.length&&(F.rtcp.ssrc=G.sendEncodingParameters[0].ssrc),G.rtpReceiver.receive(F))},O.prototype.setLocalDescription=function(G){var A=this;if(!k("setLocalDescription",G.type,this.signalingState)||this._isClosed)return Promise.reject(M("InvalidStateError","Can not set local "+G.type+" in state "+A.signalingState));var N,F;if("offer"===G.type)N=I.splitSections(G.sdp),F=N.shift(),N.forEach(function(B,V){var H=I.parseRtpParameters(B);A.transceivers[V].localCapabilities=H}),this.transceivers.forEach(function(B,V){A._gather(B.mid,V)});else if("answer"===G.type){N=I.splitSections(A.remoteDescription.sdp),F=N.shift();var z=0<I.matchPrefix(F,"a=ice-lite").length;N.forEach(function(B,V){var H=A.transceivers[V],W=H.iceGatherer,q=H.iceTransport,K=H.dtlsTransport,J=H.localCapabilities,X=H.remoteCapabilities,Y=I.isRejected(B)&&0===I.matchPrefix(B,"a=bundle-only").length;if(!Y&&!H.isDatachannel){var Z=I.getIceParameters(B,F),$=I.getDtlsParameters(B,F);z&&($.role="server"),A.usingBundle&&0!==V||(A._gather(H.mid,V),"new"===q.state&&q.start(W,Z,z?"controlling":"controlled"),"new"===K.state&&K.start($));var Q=P(J,X);A._transceive(H,0<Q.codecs.length,!1)}})}switch(this.localDescription={type:G.type,sdp:G.sdp},G.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError("unsupported type \""+G.type+"\"");}return Promise.resolve()},O.prototype.setRemoteDescription=function(G){var A=this;if(!k("setRemoteDescription",G.type,this.signalingState)||this._isClosed)return Promise.reject(M("InvalidStateError","Can not set remote "+G.type+" in state "+A.signalingState));var N={};this.remoteStreams.forEach(function(q){N[q.id]=q});var F=[],z=I.splitSections(G.sdp),B=z.shift(),V=0<I.matchPrefix(B,"a=ice-lite").length,H=0<I.matchPrefix(B,"a=group:BUNDLE ").length;this.usingBundle=H;var W=I.matchPrefix(B,"a=ice-options:")[0];switch(this.canTrickleIceCandidates=!!W&&0<=W.substr(14).split(" ").indexOf("trickle"),z.forEach(function(q,K){var J=I.splitLines(q),X=I.getKind(q),Y=I.isRejected(q)&&0===I.matchPrefix(q,"a=bundle-only").length,Z=J[0].substr(2).split(" ")[2],$=I.getDirection(q,B),Q=I.parseMsid(q),ee=I.getMid(q)||I.generateIdentifier();if("application"===X&&"DTLS/SCTP"===Z)return void(A.transceivers[K]={mid:ee,isDatachannel:!0});var re,ae,ne,ie,se,oe,de,ce,pe,le,fe,me=I.parseRtpParameters(q);Y||(le=I.getIceParameters(q,B),fe=I.getDtlsParameters(q,B),fe.role="client"),de=I.parseRtpEncodingParameters(q);var he=I.parseRtcpParameters(q),ue=0<I.matchPrefix(q,"a=end-of-candidates",B).length,ge=I.matchPrefix(q,"a=candidate:").map(function(ye){return I.parseCandidate(ye)}).filter(function(ye){return 1===ye.component});if(("offer"===G.type||"answer"===G.type)&&!Y&&H&&0<K&&A.transceivers[K]&&(A._disposeIceAndDtlsTransports(K),A.transceivers[K].iceGatherer=A.transceivers[0].iceGatherer,A.transceivers[K].iceTransport=A.transceivers[0].iceTransport,A.transceivers[K].dtlsTransport=A.transceivers[0].dtlsTransport,A.transceivers[K].rtpSender&&A.transceivers[K].rtpSender.setTransport(A.transceivers[0].dtlsTransport),A.transceivers[K].rtpReceiver&&A.transceivers[K].rtpReceiver.setTransport(A.transceivers[0].dtlsTransport)),"offer"===G.type&&!Y){re=A.transceivers[K]||A._createTransceiver(X),re.mid=ee,re.iceGatherer||(re.iceGatherer=A._createIceGatherer(K,H)),ge.length&&"new"===re.iceTransport.state&&(ue&&(!H||0===K)?re.iceTransport.setRemoteCandidates(ge):ge.forEach(function(ye){E(re.iceTransport,ye)})),ce=w.RTCRtpReceiver.getCapabilities(X),15019>D&&(ce.codecs=ce.codecs.filter(function(ye){return"rtx"!==ye.name})),oe=re.sendEncodingParameters||[{ssrc:1001*(2*K+2)}];var ve=!1;if("sendrecv"!==$&&"sendonly"!==$)re.rtpReceiver&&re.rtpReceiver.track&&(re.associatedRemoteMediaStreams.forEach(function(ye){var Te=ye.getTracks().find(function(Se){return Se.id===re.rtpReceiver.track.id});Te&&x(Te,ye)}),re.associatedRemoteMediaStreams=[]);else if(ve=!re.rtpReceiver,se=re.rtpReceiver||new w.RTCRtpReceiver(re.dtlsTransport,X),ve){var Ce;pe=se.track,Q&&"-"===Q.stream||(Q?(!N[Q.stream]&&(N[Q.stream]=new w.MediaStream,Object.defineProperty(N[Q.stream],"id",{get:function get(){return Q.stream}})),Object.defineProperty(pe,"id",{get:function get(){return Q.track}}),Ce=N[Q.stream]):(!N.default&&(N.default=new w.MediaStream),Ce=N.default)),Ce&&(_(pe,Ce),re.associatedRemoteMediaStreams.push(Ce)),F.push([pe,se,Ce])}re.localCapabilities=ce,re.remoteCapabilities=me,re.rtpReceiver=se,re.rtcpParameters=he,re.sendEncodingParameters=oe,re.recvEncodingParameters=de,A._transceive(A.transceivers[K],!1,ve)}else"answer"!==G.type||Y||(re=A.transceivers[K],ae=re.iceGatherer,ne=re.iceTransport,ie=re.dtlsTransport,se=re.rtpReceiver,oe=re.sendEncodingParameters,ce=re.localCapabilities,A.transceivers[K].recvEncodingParameters=de,A.transceivers[K].remoteCapabilities=me,A.transceivers[K].rtcpParameters=he,ge.length&&"new"===ne.state&&((V||ue)&&(!H||0===K)?ne.setRemoteCandidates(ge):ge.forEach(function(ye){E(re.iceTransport,ye)})),H&&0!==K||("new"===ne.state&&ne.start(ae,le,"controlling"),"new"===ie.state&&ie.start(fe)),A._transceive(re,"sendrecv"===$||"recvonly"===$,"sendrecv"===$||"sendonly"===$),se&&("sendrecv"===$||"sendonly"===$)?(pe=se.track,Q?(!N[Q.stream]&&(N[Q.stream]=new w.MediaStream),_(pe,N[Q.stream]),F.push([pe,se,N[Q.stream]])):(!N.default&&(N.default=new w.MediaStream),_(pe,N.default),F.push([pe,se,N.default]))):delete re.rtpReceiver)}),void 0===this._dtlsRole&&(this._dtlsRole="offer"===G.type?"active":"passive"),this.remoteDescription={type:G.type,sdp:G.sdp},G.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError("unsupported type \""+G.type+"\"");}return Object.keys(N).forEach(function(q){var K=N[q];if(K.getTracks().length){if(-1===A.remoteStreams.indexOf(K)){A.remoteStreams.push(K);var J=new Event("addstream");J.stream=K,w.setTimeout(function(){A._dispatchEvent("addstream",J)})}F.forEach(function(X){var Y=X[0],Z=X[1];K.id!==X[2].id||L(A,Y,Z,[K])})}}),F.forEach(function(q){q[2]||L(A,q[0],q[1],[])}),w.setTimeout(function(){A&&A.transceivers&&A.transceivers.forEach(function(q){q.iceTransport&&"new"===q.iceTransport.state&&0<q.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),q.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},O.prototype.close=function(){this.transceivers.forEach(function(G){G.iceTransport&&G.iceTransport.stop(),G.dtlsTransport&&G.dtlsTransport.stop(),G.rtpSender&&G.rtpSender.stop(),G.rtpReceiver&&G.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},O.prototype._updateSignalingState=function(G){this.signalingState=G;var A=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",A)},O.prototype._maybeFireNegotiationNeeded=function(){var G=this;"stable"!==this.signalingState||!0===this.needNegotiation||(this.needNegotiation=!0,w.setTimeout(function(){if(!1!==G.needNegotiation){G.needNegotiation=!1;var A=new Event("negotiationneeded");G._dispatchEvent("negotiationneeded",A)}},0))},O.prototype._updateConnectionState=function(){var G,A={"new":0,closed:0,connecting:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(F){A[F.iceTransport.state]++,A[F.dtlsTransport.state]++}),A.connected+=A.completed,G="new",0<A.failed?G="failed":0<A.connecting||0<A.checking?G="connecting":0<A.disconnected?G="disconnected":0<A.new?G="new":(0<A.connected||0<A.completed)&&(G="connected"),G!==this.iceConnectionState){this.iceConnectionState=G;var N=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",N)}},O.prototype.createOffer=function(){var G=this;if(this._isClosed)return Promise.reject(M("InvalidStateError","Can not call createOffer after close"));var A=this.transceivers.filter(function(V){return"audio"===V.kind}).length,N=this.transceivers.filter(function(V){return"video"===V.kind}).length,F=arguments[0];if(F){if(F.mandatory||F.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==F.offerToReceiveAudio&&(!0===F.offerToReceiveAudio?A=1:!1===F.offerToReceiveAudio?A=0:A=F.offerToReceiveAudio),void 0!==F.offerToReceiveVideo&&(!0===F.offerToReceiveVideo?N=1:!1===F.offerToReceiveVideo?N=0:N=F.offerToReceiveVideo)}for(this.transceivers.forEach(function(V){"audio"===V.kind?(A--,0>A&&(V.wantReceive=!1)):"video"===V.kind&&(N--,0>N&&(V.wantReceive=!1))});0<A||0<N;)0<A&&(this._createTransceiver("audio"),A--),0<N&&(this._createTransceiver("video"),N--);var z=I.writeSessionBoilerplate(this._sdpSessionId,this._sdpSessionVersion++);this.transceivers.forEach(function(V,H){var W=V.track,q=V.kind,K=I.generateIdentifier();V.mid=K,V.iceGatherer||(V.iceGatherer=G._createIceGatherer(H,G.usingBundle));var J=w.RTCRtpSender.getCapabilities(q);15019>D&&(J.codecs=J.codecs.filter(function(Y){return"rtx"!==Y.name})),J.codecs.forEach(function(Y){"H264"===Y.name&&void 0===Y.parameters["level-asymmetry-allowed"]&&(Y.parameters["level-asymmetry-allowed"]="1")});var X=V.sendEncodingParameters||[{ssrc:1001*(2*H+1)}];W&&15019<=D&&"video"===q&&!X[0].rtx&&(X[0].rtx={ssrc:X[0].ssrc+1}),V.wantReceive&&(V.rtpReceiver=new w.RTCRtpReceiver(V.dtlsTransport,q)),V.localCapabilities=J,V.sendEncodingParameters=X}),"max-compat"!==this._config.bundlePolicy&&(z+="a=group:BUNDLE "+this.transceivers.map(function(V){return V.mid}).join(" ")+"\r\n"),z+="a=ice-options:trickle\r\n",this.transceivers.forEach(function(V,H){z+=S(V,V.localCapabilities,"offer",V.stream,G._dtlsRole),z+="a=rtcp-rsize\r\n",V.iceGatherer&&"new"!==G.iceGatheringState&&(0===H||!G.usingBundle)&&(V.iceGatherer.getLocalCandidates().forEach(function(W){W.component=1,z+="a="+I.writeCandidate(W)+"\r\n"}),"completed"===V.iceGatherer.state&&(z+="a=end-of-candidates\r\n"))});var B=new w.RTCSessionDescription({type:"offer",sdp:z});return Promise.resolve(B)},O.prototype.createAnswer=function(){var G=this;if(this._isClosed)return Promise.reject(M("InvalidStateError","Can not call createAnswer after close"));var A=I.writeSessionBoilerplate(this._sdpSessionId,this._sdpSessionVersion++);this.usingBundle&&(A+="a=group:BUNDLE "+this.transceivers.map(function(z){return z.mid}).join(" ")+"\r\n");var N=I.splitSections(this.remoteDescription.sdp).length-1;this.transceivers.forEach(function(z,B){if(!(B+1>N)){if(z.isDatachannel)return void(A+="m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+z.mid+"\r\n");if(z.stream){var V;"audio"===z.kind?V=z.stream.getAudioTracks()[0]:"video"===z.kind&&(V=z.stream.getVideoTracks()[0]),V&&15019<=D&&"video"===z.kind&&!z.sendEncodingParameters[0].rtx&&(z.sendEncodingParameters[0].rtx={ssrc:z.sendEncodingParameters[0].ssrc+1})}var H=P(z.localCapabilities,z.remoteCapabilities),W=H.codecs.filter(function(q){return"rtx"===q.name.toLowerCase()}).length;!W&&z.sendEncodingParameters[0].rtx&&delete z.sendEncodingParameters[0].rtx,A+=S(z,H,"answer",z.stream,G._dtlsRole),z.rtcpParameters&&z.rtcpParameters.reducedSize&&(A+="a=rtcp-rsize\r\n")}});var F=new w.RTCSessionDescription({type:"answer",sdp:A});return Promise.resolve(F)},O.prototype.addIceCandidate=function(G){var A;if(!G||""===G.candidate)for(var N=0;N<this.transceivers.length&&(this.transceivers[N].isDatachannel||(this.transceivers[N].iceTransport.addRemoteCandidate({}),A=I.splitSections(this.remoteDescription.sdp),A[N+1]+="a=end-of-candidates\r\n",this.remoteDescription.sdp=A.join(""),!this.usingBundle));N++);else if(!(void 0!==G.sdpMLineIndex||G.sdpMid))throw new TypeError("sdpMLineIndex or sdpMid required");else{if(!this.remoteDescription)return Promise.reject(M("InvalidStateError","Can not add ICE candidate without a remote description"));var F=G.sdpMLineIndex;if(G.sdpMid)for(var z=0;z<this.transceivers.length;z++)if(this.transceivers[z].mid===G.sdpMid){F=z;break}var B=this.transceivers[F];if(B){if(B.isDatachannel)return Promise.resolve();var V=0<Object.keys(G.candidate).length?I.parseCandidate(G.candidate):{};if("tcp"===V.protocol&&(0===V.port||9===V.port))return Promise.resolve();if(V.component&&1!==V.component)return Promise.resolve();if((0===F||0<F&&B.iceTransport!==this.transceivers[0].iceTransport)&&!E(B.iceTransport,V))return Promise.reject(M("OperationError","Can not add ICE candidate"));var H=G.candidate.trim();0===H.indexOf("a=")&&(H=H.substr(2)),A=I.splitSections(this.remoteDescription.sdp),A[F+1]+="a="+(V.type?H:"end-of-candidates")+"\r\n",this.remoteDescription.sdp=A.join("")}else return Promise.reject(M("OperationError","Can not add ICE candidate"))}return Promise.resolve()},O.prototype.getStats=function(){var G=[];this.transceivers.forEach(function(N){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(F){N[F]&&G.push(N[F].getStats())})});var A=function(N){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[N.type]||N.type};return new Promise(function(N){var F=new Map;Promise.all(G).then(function(z){z.forEach(function(B){Object.keys(B).forEach(function(V){B[V].type=A(B[V]),F.set(V,B[V])})}),N(F)})})};var U=["createOffer","createAnswer"];return U.forEach(function(G){var A=O.prototype[G];O.prototype[G]=function(){var N=arguments;return"function"==typeof N[0]||"function"==typeof N[1]?A.apply(this,[arguments[2]]).then(function(F){"function"==typeof N[0]&&N[0].apply(null,[F])},function(F){"function"==typeof N[1]&&N[1].apply(null,[F])}):A.apply(this,arguments)}}),U=["setLocalDescription","setRemoteDescription","addIceCandidate"],U.forEach(function(G){var A=O.prototype[G];O.prototype[G]=function(){var N=arguments;return"function"==typeof N[1]||"function"==typeof N[2]?A.apply(this,arguments).then(function(){"function"==typeof N[1]&&N[1].apply(null)},function(F){"function"==typeof N[2]&&N[2].apply(null,[F])}):A.apply(this,arguments)}}),["getStats"].forEach(function(G){var A=O.prototype[G];O.prototype[G]=function(){var N=arguments;return"function"==typeof N[1]?A.apply(this,arguments).then(function(){"function"==typeof N[1]&&N[1].apply(null)}):A.apply(this,arguments)}}),O}},{sdp:2}],2:[function(C,y){"use strict";var S={};S.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},S.localCName=S.generateIdentifier(),S.splitLines=function(R){return R.trim().split("\n").map(function(P){return P.trim()})},S.splitSections=function(R){var P=R.split("\nm=");return P.map(function(k,E){return(0<E?"m="+k:k).trim()+"\r\n"})},S.matchPrefix=function(R,P){return S.splitLines(R).filter(function(k){return 0===k.indexOf(P)})},S.parseCandidate=function(R){var P=0===R.indexOf("a=candidate:")?R.substring(12).split(" "):R.substring(10).split(" ");for(var k={foundation:P[0],component:parseInt(P[1],10),protocol:P[2].toLowerCase(),priority:parseInt(P[3],10),ip:P[4],port:parseInt(P[5],10),type:P[7]},E=8;E<P.length;E+=2)switch(P[E]){case"raddr":k.relatedAddress=P[E+1];break;case"rport":k.relatedPort=parseInt(P[E+1],10);break;case"tcptype":k.tcpType=P[E+1];break;case"ufrag":k.ufrag=P[E+1],k.usernameFragment=P[E+1];break;default:k[P[E]]=P[E+1];}return k},S.writeCandidate=function(R){var P=[R.foundation,R.component,R.protocol.toUpperCase(),R.priority,R.ip,R.port],k=R.type;return P.push("typ"),P.push(k),"host"!==k&&R.relatedAddress&&R.relatedPort&&(P.push("raddr"),P.push(R.relatedAddress),P.push("rport"),P.push(R.relatedPort)),R.tcpType&&"tcp"===R.protocol.toLowerCase()&&(P.push("tcptype"),P.push(R.tcpType)),R.ufrag&&(P.push("ufrag"),P.push(R.ufrag)),"candidate:"+P.join(" ")},S.parseIceOptions=function(R){return R.substr(14).split(" ")},S.parseRtpMap=function(R){var P=R.substr(9).split(" "),k={payloadType:parseInt(P.shift(),10)};return P=P[0].split("/"),k.name=P[0],k.clockRate=parseInt(P[1],10),k.numChannels=3===P.length?parseInt(P[2],10):1,k},S.writeRtpMap=function(R){var P=R.payloadType;return void 0!==R.preferredPayloadType&&(P=R.preferredPayloadType),"a=rtpmap:"+P+" "+R.name+"/"+R.clockRate+(1===R.numChannels?"":"/"+R.numChannels)+"\r\n"},S.parseExtmap=function(R){var P=R.substr(9).split(" ");return{id:parseInt(P[0],10),direction:0<P[0].indexOf("/")?P[0].split("/")[1]:"sendrecv",uri:P[1]}},S.writeExtmap=function(R){return"a=extmap:"+(R.id||R.preferredId)+(R.direction&&"sendrecv"!==R.direction?"/"+R.direction:"")+" "+R.uri+"\r\n"},S.parseFmtp=function(R){for(var k,P={},E=R.substr(R.indexOf(" ")+1).split(";"),_=0;_<E.length;_++)k=E[_].trim().split("="),P[k[0].trim()]=k[1];return P},S.writeFmtp=function(R){var P="",k=R.payloadType;if(void 0!==R.preferredPayloadType&&(k=R.preferredPayloadType),R.parameters&&Object.keys(R.parameters).length){var E=[];Object.keys(R.parameters).forEach(function(_){E.push(_+"="+R.parameters[_])}),P+="a=fmtp:"+k+" "+E.join(";")+"\r\n"}return P},S.parseRtcpFb=function(R){var P=R.substr(R.indexOf(" ")+1).split(" ");return{type:P.shift(),parameter:P.join(" ")}},S.writeRtcpFb=function(R){var P="",k=R.payloadType;return void 0!==R.preferredPayloadType&&(k=R.preferredPayloadType),R.rtcpFeedback&&R.rtcpFeedback.length&&R.rtcpFeedback.forEach(function(E){P+="a=rtcp-fb:"+k+" "+E.type+(E.parameter&&E.parameter.length?" "+E.parameter:"")+"\r\n"}),P},S.parseSsrcMedia=function(R){var P=R.indexOf(" "),k={ssrc:parseInt(R.substr(7,P-7),10)},E=R.indexOf(":",P);return-1<E?(k.attribute=R.substr(P+1,E-P-1),k.value=R.substr(E+1)):k.attribute=R.substr(P+1),k},S.getMid=function(R){var P=S.matchPrefix(R,"a=mid:")[0];if(P)return P.substr(6)},S.parseFingerprint=function(R){var P=R.substr(14).split(" ");return{algorithm:P[0].toLowerCase(),value:P[1]}},S.getDtlsParameters=function(R,P){var k=S.matchPrefix(R+P,"a=fingerprint:");return{role:"auto",fingerprints:k.map(S.parseFingerprint)}},S.writeDtlsParameters=function(R,P){var k="a=setup:"+P+"\r\n";return R.fingerprints.forEach(function(E){k+="a=fingerprint:"+E.algorithm+" "+E.value+"\r\n"}),k},S.getIceParameters=function(R,P){var k=S.splitLines(R);k=k.concat(S.splitLines(P));var E={usernameFragment:k.filter(function(_){return 0===_.indexOf("a=ice-ufrag:")})[0].substr(12),password:k.filter(function(_){return 0===_.indexOf("a=ice-pwd:")})[0].substr(10)};return E},S.writeIceParameters=function(R){return"a=ice-ufrag:"+R.usernameFragment+"\r\na=ice-pwd:"+R.password+"\r\n"},S.parseRtpParameters=function(R){for(var P={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},k=S.splitLines(R),E=k[0].split(" "),_=3;_<E.length;_++){var x=E[_],L=S.matchPrefix(R,"a=rtpmap:"+x+" ")[0];if(L){var M=S.parseRtpMap(L),I=S.matchPrefix(R,"a=fmtp:"+x+" ");switch(M.parameters=I.length?S.parseFmtp(I[0]):{},M.rtcpFeedback=S.matchPrefix(R,"a=rtcp-fb:"+x+" ").map(S.parseRtcpFb),P.codecs.push(M),M.name.toUpperCase()){case"RED":case"ULPFEC":P.fecMechanisms.push(M.name.toUpperCase());break;default:}}}return S.matchPrefix(R,"a=extmap:").forEach(function(w){P.headerExtensions.push(S.parseExtmap(w))}),P},S.writeRtpDescription=function(R,P){var k="";k+="m="+R+" ",k+=0<P.codecs.length?"9":"0",k+=" UDP/TLS/RTP/SAVPF ",k+=P.codecs.map(function(_){return void 0===_.preferredPayloadType?_.payloadType:_.preferredPayloadType}).join(" ")+"\r\n",k+="c=IN IP4 0.0.0.0\r\n",k+="a=rtcp:9 IN IP4 0.0.0.0\r\n",P.codecs.forEach(function(_){k+=S.writeRtpMap(_),k+=S.writeFmtp(_),k+=S.writeRtcpFb(_)});var E=0;return P.codecs.forEach(function(_){_.maxptime>E&&(E=_.maxptime)}),0<E&&(k+="a=maxptime:"+E+"\r\n"),k+="a=rtcp-mux\r\n",P.headerExtensions.forEach(function(_){k+=S.writeExtmap(_)}),k},S.parseRtpEncodingParameters=function(R){var M,P=[],k=S.parseRtpParameters(R),E=-1!==k.fecMechanisms.indexOf("RED"),_=-1!==k.fecMechanisms.indexOf("ULPFEC"),x=S.matchPrefix(R,"a=ssrc:").map(function(D){return S.parseSsrcMedia(D)}).filter(function(D){return"cname"===D.attribute}),L=0<x.length&&x[0].ssrc,I=S.matchPrefix(R,"a=ssrc-group:FID").map(function(D){var O=D.split(" ");return O.shift(),O.map(function(U){return parseInt(U,10)})});0<I.length&&1<I[0].length&&I[0][0]===L&&(M=I[0][1]),k.codecs.forEach(function(D){if("RTX"===D.name.toUpperCase()&&D.parameters.apt){var O={ssrc:L,codecPayloadType:parseInt(D.parameters.apt,10),rtx:{ssrc:M}};P.push(O),E&&(O=JSON.parse(JSON.stringify(O)),O.fec={ssrc:M,mechanism:_?"red+ulpfec":"red"},P.push(O))}}),0===P.length&&L&&P.push({ssrc:L});var w=S.matchPrefix(R,"b=");return w.length&&(w=0===w[0].indexOf("b=TIAS:")?parseInt(w[0].substr(7),10):0===w[0].indexOf("b=AS:")?0.95*(1e3*parseInt(w[0].substr(5),10))-16000:void 0,P.forEach(function(D){D.maxBitrate=w})),P},S.parseRtcpParameters=function(R){var P={},E=S.matchPrefix(R,"a=ssrc:").map(function(L){return S.parseSsrcMedia(L)}).filter(function(L){return"cname"===L.attribute})[0];E&&(P.cname=E.value,P.ssrc=E.ssrc);var _=S.matchPrefix(R,"a=rtcp-rsize");P.reducedSize=0<_.length,P.compound=0===_.length;var x=S.matchPrefix(R,"a=rtcp-mux");return P.mux=0<x.length,P},S.parseMsid=function(R){var P,k=S.matchPrefix(R,"a=msid:");if(1===k.length)return P=k[0].substr(7).split(" "),{stream:P[0],track:P[1]};var E=S.matchPrefix(R,"a=ssrc:").map(function(_){return S.parseSsrcMedia(_)}).filter(function(_){return"msid"===_.attribute});if(0<E.length)return P=E[0].value.split(" "),{stream:P[0],track:P[1]}},S.generateSessionId=function(){return Math.random().toString().substr(2,21)},S.writeSessionBoilerplate=function(R,P){var k,E=void 0===P?2:P;return k=R?R:S.generateSessionId(),"v=0\r\no=thisisadapterortc "+k+" "+E+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},S.writeMediaSection=function(R,P,k,E){var _=S.writeRtpDescription(R.kind,P);if(_+=S.writeIceParameters(R.iceGatherer.getLocalParameters()),_+=S.writeDtlsParameters(R.dtlsTransport.getLocalParameters(),"offer"===k?"actpass":"active"),_+="a=mid:"+R.mid+"\r\n",_+=R.direction?"a="+R.direction+"\r\n":R.rtpSender&&R.rtpReceiver?"a=sendrecv\r\n":R.rtpSender?"a=sendonly\r\n":R.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",R.rtpSender){var x="msid:"+E.id+" "+R.rtpSender.track.id+"\r\n";_+="a="+x,_+="a=ssrc:"+R.sendEncodingParameters[0].ssrc+" "+x,R.sendEncodingParameters[0].rtx&&(_+="a=ssrc:"+R.sendEncodingParameters[0].rtx.ssrc+" "+x,_+="a=ssrc-group:FID "+R.sendEncodingParameters[0].ssrc+" "+R.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return _+="a=ssrc:"+R.sendEncodingParameters[0].ssrc+" cname:"+S.localCName+"\r\n",R.rtpSender&&R.sendEncodingParameters[0].rtx&&(_+="a=ssrc:"+R.sendEncodingParameters[0].rtx.ssrc+" cname:"+S.localCName+"\r\n"),_},S.getDirection=function(R,P){for(var k=S.splitLines(R),E=0;E<k.length;E++)switch(k[E]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return k[E].substr(2);default:}return P?S.getDirection(P):"sendrecv"},S.getKind=function(R){var P=S.splitLines(R),k=P[0].split(" ");return k[0].substr(2)},S.isRejected=function(R){return"0"===R.split(" ",2)[1]},S.parseMLine=function(R){var P=S.splitLines(R),k=P[0].split(" ");return{kind:k[0].substr(2),port:parseInt(k[1],10),protocol:k[2],fmt:k.slice(3).join(" ")}},"object"===("undefined"==typeof y?"undefined":_typeof(y))&&(y.exports=S)},{}],3:[function(C,y){(function(S){"use strict";var R=C("./adapter_factory.js");y.exports=R({window:S.window})}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./adapter_factory.js":4}],4:[function(C,y){"use strict";var S=C("./utils");y.exports=function(R,P){var k=R&&R.window,E={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var _ in P)hasOwnProperty.call(P,_)&&(E[_]=P[_]);var x=S.log,L=S.detectBrowser(k),M=C("./chrome/chrome_shim")||null,I=C("./edge/edge_shim")||null,w=C("./firefox/firefox_shim")||null,D=C("./safari/safari_shim")||null,O=C("./common_shim")||null,U={browserDetails:L,commonShim:O,extractVersion:S.extractVersion,disableLog:S.disableLog,disableWarnings:S.disableWarnings};switch(L.browser){case"chrome":if(!M||!M.shimPeerConnection||!E.shimChrome)return x("Chrome shim is not included in this adapter release."),U;x("adapter.js shimming chrome."),U.browserShim=M,O.shimCreateObjectURL(k),M.shimGetUserMedia(k),M.shimMediaStream(k),M.shimSourceObject(k),M.shimPeerConnection(k),M.shimOnTrack(k),M.shimAddTrackRemoveTrack(k),M.shimGetSendersWithDtmf(k),O.shimRTCIceCandidate(k),O.shimMaxMessageSize(k),O.shimSendThrowTypeError(k);break;case"firefox":if(!w||!w.shimPeerConnection||!E.shimFirefox)return x("Firefox shim is not included in this adapter release."),U;x("adapter.js shimming firefox."),U.browserShim=w,O.shimCreateObjectURL(k),w.shimGetUserMedia(k),w.shimSourceObject(k),w.shimPeerConnection(k),w.shimOnTrack(k),w.shimRemoveStream(k),O.shimRTCIceCandidate(k),O.shimMaxMessageSize(k),O.shimSendThrowTypeError(k);break;case"edge":if(!I||!I.shimPeerConnection||!E.shimEdge)return x("MS edge shim is not included in this adapter release."),U;x("adapter.js shimming edge."),U.browserShim=I,O.shimCreateObjectURL(k),I.shimGetUserMedia(k),I.shimPeerConnection(k),I.shimReplaceTrack(k),O.shimMaxMessageSize(k),O.shimSendThrowTypeError(k);break;case"safari":if(!D||!E.shimSafari)return x("Safari shim is not included in this adapter release."),U;x("adapter.js shimming safari."),U.browserShim=D,O.shimCreateObjectURL(k),D.shimRTCIceServerUrls(k),D.shimCallbacksAPI(k),D.shimLocalStreamsAPI(k),D.shimRemoteStreamsAPI(k),D.shimTrackEventTransceiver(k),D.shimGetUserMedia(k),D.shimCreateOfferLegacy(k),O.shimRTCIceCandidate(k),O.shimMaxMessageSize(k),O.shimSendThrowTypeError(k);break;default:x("Unsupported browser!");}return U}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":8,"./firefox/firefox_shim":10,"./safari/safari_shim":12,"./utils":13}],5:[function(C,y){"use strict";var S=C("../utils.js"),R=S.log;y.exports={shimGetUserMedia:C("./getusermedia"),shimMediaStream:function shimMediaStream(P){P.MediaStream=P.MediaStream||P.webkitMediaStream},shimOnTrack:function shimOnTrack(P){if("object"===("undefined"==typeof P?"undefined":_typeof(P))&&P.RTCPeerConnection&&!("ontrack"in P.RTCPeerConnection.prototype)){Object.defineProperty(P.RTCPeerConnection.prototype,"ontrack",{get:function get(){return this._ontrack},set:function set(E){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=E)}});var k=P.RTCPeerConnection.prototype.setRemoteDescription;P.RTCPeerConnection.prototype.setRemoteDescription=function(){var E=this;return E._ontrackpoly||(E._ontrackpoly=function(_){_.stream.addEventListener("addtrack",function(x){var L=P.RTCPeerConnection.prototype.getReceivers?E.getReceivers().find(function(I){return I.track&&I.track.id===x.track.id}):{track:x.track};var M=new Event("track");M.track=x.track,M.receiver=L,M.transceiver={receiver:L},M.streams=[_.stream],E.dispatchEvent(M)}),_.stream.getTracks().forEach(function(x){var L=P.RTCPeerConnection.prototype.getReceivers?E.getReceivers().find(function(I){return I.track&&I.track.id===x.id}):{track:x};var M=new Event("track");M.track=x,M.receiver=L,M.transceiver={receiver:L},M.streams=[_.stream],E.dispatchEvent(M)})},E.addEventListener("addstream",E._ontrackpoly)),k.apply(E,arguments)}}else"RTCRtpTransceiver"in P||S.wrapPeerConnectionEvent(P,"track",function(E){return E.transceiver||(E.transceiver={receiver:E.receiver}),E})},shimGetSendersWithDtmf:function shimGetSendersWithDtmf(P){if("object"===("undefined"==typeof P?"undefined":_typeof(P))&&P.RTCPeerConnection&&!("getSenders"in P.RTCPeerConnection.prototype)&&"createDTMFSender"in P.RTCPeerConnection.prototype){var k=function(I,w){return{track:w,get dtmf(){return void 0===this._dtmf&&("audio"===w.kind?this._dtmf=I.createDTMFSender(w):this._dtmf=null),this._dtmf},_pc:I}};if(!P.RTCPeerConnection.prototype.getSenders){P.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var E=P.RTCPeerConnection.prototype.addTrack;P.RTCPeerConnection.prototype.addTrack=function(I){var D=this,O=E.apply(D,arguments);return O||(O=k(D,I),D._senders.push(O)),O};var _=P.RTCPeerConnection.prototype.removeTrack;P.RTCPeerConnection.prototype.removeTrack=function(I){var w=this;_.apply(w,arguments);var D=w._senders.indexOf(I);-1!==D&&w._senders.splice(D,1)}}var x=P.RTCPeerConnection.prototype.addStream;P.RTCPeerConnection.prototype.addStream=function(I){var w=this;w._senders=w._senders||[],x.apply(w,[I]),I.getTracks().forEach(function(D){w._senders.push(k(w,D))})};var L=P.RTCPeerConnection.prototype.removeStream;P.RTCPeerConnection.prototype.removeStream=function(I){var w=this;w._senders=w._senders||[],L.apply(w,[I]),I.getTracks().forEach(function(D){var O=w._senders.find(function(U){return U.track===D});O&&w._senders.splice(w._senders.indexOf(O),1)})}}else if("object"===("undefined"==typeof P?"undefined":_typeof(P))&&P.RTCPeerConnection&&"getSenders"in P.RTCPeerConnection.prototype&&"createDTMFSender"in P.RTCPeerConnection.prototype&&P.RTCRtpSender&&!("dtmf"in P.RTCRtpSender.prototype)){var M=P.RTCPeerConnection.prototype.getSenders;P.RTCPeerConnection.prototype.getSenders=function(){var I=this,w=M.apply(I,[]);return w.forEach(function(D){D._pc=I}),w},Object.defineProperty(P.RTCRtpSender.prototype,"dtmf",{get:function get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSourceObject:function shimSourceObject(P){var k=P&&P.URL;"object"===("undefined"==typeof P?"undefined":_typeof(P))&&P.HTMLMediaElement&&!("srcObject"in P.HTMLMediaElement.prototype)&&Object.defineProperty(P.HTMLMediaElement.prototype,"srcObject",{get:function get(){return this._srcObject},set:function set(E){var _=this;return this._srcObject=E,this.src&&k.revokeObjectURL(this.src),E?void(this.src=k.createObjectURL(E),E.addEventListener("addtrack",function(){_.src&&k.revokeObjectURL(_.src),_.src=k.createObjectURL(E)}),E.addEventListener("removetrack",function(){_.src&&k.revokeObjectURL(_.src),_.src=k.createObjectURL(E)})):(this.src="",void 0)}})},shimAddTrackRemoveTrackWithNative:function shimAddTrackRemoveTrackWithNative(P){P.RTCPeerConnection.prototype.getLocalStreams=function(){var L=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(M){return L._shimmedLocalStreams[M][0]})};var k=P.RTCPeerConnection.prototype.addTrack;P.RTCPeerConnection.prototype.addTrack=function(L,M){if(!M)return k.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var I=k.apply(this,arguments);return this._shimmedLocalStreams[M.id]?-1===this._shimmedLocalStreams[M.id].indexOf(I)&&this._shimmedLocalStreams[M.id].push(I):this._shimmedLocalStreams[M.id]=[M,I],I};var E=P.RTCPeerConnection.prototype.addStream;P.RTCPeerConnection.prototype.addStream=function(L){var M=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},L.getTracks().forEach(function(D){var O=M.getSenders().find(function(U){return U.track===D});if(O)throw new DOMException("Track already exists.","InvalidAccessError")});var I=M.getSenders();E.apply(this,arguments);var w=M.getSenders().filter(function(D){return-1===I.indexOf(D)});this._shimmedLocalStreams[L.id]=[L].concat(w)};var _=P.RTCPeerConnection.prototype.removeStream;P.RTCPeerConnection.prototype.removeStream=function(L){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[L.id],_.apply(this,arguments)};var x=P.RTCPeerConnection.prototype.removeTrack;P.RTCPeerConnection.prototype.removeTrack=function(L){var M=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},L&&Object.keys(this._shimmedLocalStreams).forEach(function(I){var w=M._shimmedLocalStreams[I].indexOf(L);-1!==w&&M._shimmedLocalStreams[I].splice(w,1),1===M._shimmedLocalStreams[I].length&&delete M._shimmedLocalStreams[I]}),x.apply(this,arguments)}},shimAddTrackRemoveTrack:function shimAddTrackRemoveTrack(P){function k(D,O){var U=O.sdp;return Object.keys(D._reverseStreams||[]).forEach(function(G){var A=D._reverseStreams[G],N=D._streams[A.id];U=U.replace(new RegExp(N.id,"g"),A.id)}),new RTCSessionDescription({type:O.type,sdp:U})}function E(D,O){var U=O.sdp;return Object.keys(D._reverseStreams||[]).forEach(function(G){var A=D._reverseStreams[G],N=D._streams[A.id];U=U.replace(new RegExp(A.id,"g"),N.id)}),new RTCSessionDescription({type:O.type,sdp:U})}var _=S.detectBrowser(P);if(P.RTCPeerConnection.prototype.addTrack&&65<=_.version)return this.shimAddTrackRemoveTrackWithNative(P);var x=P.RTCPeerConnection.prototype.getLocalStreams;P.RTCPeerConnection.prototype.getLocalStreams=function(){var D=this,O=x.apply(this);return D._reverseStreams=D._reverseStreams||{},O.map(function(U){return D._reverseStreams[U.id]})};var L=P.RTCPeerConnection.prototype.addStream;P.RTCPeerConnection.prototype.addStream=function(D){var O=this;if(O._streams=O._streams||{},O._reverseStreams=O._reverseStreams||{},D.getTracks().forEach(function(G){var A=O.getSenders().find(function(N){return N.track===G});if(A)throw new DOMException("Track already exists.","InvalidAccessError")}),!O._reverseStreams[D.id]){var U=new P.MediaStream(D.getTracks());O._streams[D.id]=U,O._reverseStreams[U.id]=D,D=U}L.apply(O,[D])};var M=P.RTCPeerConnection.prototype.removeStream;P.RTCPeerConnection.prototype.removeStream=function(D){var O=this;O._streams=O._streams||{},O._reverseStreams=O._reverseStreams||{},M.apply(O,[O._streams[D.id]||D]),delete O._reverseStreams[O._streams[D.id]?O._streams[D.id].id:D.id],delete O._streams[D.id]},P.RTCPeerConnection.prototype.addTrack=function(D,O){var U=this;if("closed"===U.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var G=[].slice.call(arguments,1);if(1!==G.length||!G[0].getTracks().find(function(z){return z===D}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var A=U.getSenders().find(function(z){return z.track===D});if(A)throw new DOMException("Track already exists.","InvalidAccessError");U._streams=U._streams||{},U._reverseStreams=U._reverseStreams||{};var N=U._streams[O.id];if(N)N.addTrack(D),Promise.resolve().then(function(){U.dispatchEvent(new Event("negotiationneeded"))});else{var F=new P.MediaStream([D]);U._streams[O.id]=F,U._reverseStreams[F.id]=O,U.addStream(F)}return U.getSenders().find(function(z){return z.track===D})},["createOffer","createAnswer"].forEach(function(D){var O=P.RTCPeerConnection.prototype[D];P.RTCPeerConnection.prototype[D]=function(){var U=this,G=arguments,A=arguments.length&&"function"==typeof arguments[0];return A?O.apply(U,[function(N){var F=k(U,N);G[0].apply(null,[F])},function(N){G[1]&&G[1].apply(null,N)},arguments[2]]):O.apply(U,arguments).then(function(N){return k(U,N)})}});var I=P.RTCPeerConnection.prototype.setLocalDescription;P.RTCPeerConnection.prototype.setLocalDescription=function(){var D=this;return arguments.length&&arguments[0].type?(arguments[0]=E(D,arguments[0]),I.apply(D,arguments)):I.apply(D,arguments)};var w=Object.getOwnPropertyDescriptor(P.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(P.RTCPeerConnection.prototype,"localDescription",{get:function get(){var D=this,O=w.get.apply(this);return""===O.type?O:k(D,O)}}),P.RTCPeerConnection.prototype.removeTrack=function(D){var O=this;if("closed"===O.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!D._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var U=D._pc===O;if(!U)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");O._streams=O._streams||{};var G;Object.keys(O._streams).forEach(function(A){var N=O._streams[A].getTracks().find(function(F){return D.track===F});N&&(G=O._streams[A])}),G&&(1===G.getTracks().length?O.removeStream(O._reverseStreams[G.id]):G.removeTrack(D.track),O.dispatchEvent(new Event("negotiationneeded")))}},shimPeerConnection:function shimPeerConnection(P){var k=S.detectBrowser(P);if(!P.RTCPeerConnection&&P.webkitRTCPeerConnection)P.RTCPeerConnection=function(L,M){return R("PeerConnection"),L&&L.iceTransportPolicy&&(L.iceTransports=L.iceTransportPolicy),new P.webkitRTCPeerConnection(L,M)},P.RTCPeerConnection.prototype=P.webkitRTCPeerConnection.prototype,P.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(P.RTCPeerConnection,"generateCertificate",{get:function get(){return P.webkitRTCPeerConnection.generateCertificate}});else{var E=P.RTCPeerConnection;P.RTCPeerConnection=function(L,M){if(L&&L.iceServers){for(var D,I=[],w=0;w<L.iceServers.length;w++)D=L.iceServers[w],!D.hasOwnProperty("urls")&&D.hasOwnProperty("url")?(S.deprecated("RTCIceServer.url","RTCIceServer.urls"),D=JSON.parse(JSON.stringify(D)),D.urls=D.url,I.push(D)):I.push(L.iceServers[w]);L.iceServers=I}return new E(L,M)},P.RTCPeerConnection.prototype=E.prototype,Object.defineProperty(P.RTCPeerConnection,"generateCertificate",{get:function get(){return E.generateCertificate}})}var _=P.RTCPeerConnection.prototype.getStats;P.RTCPeerConnection.prototype.getStats=function(L,M,I){var w=this,D=arguments;if(0<arguments.length&&"function"==typeof L)return _.apply(this,arguments);if(0===_.length&&(0===arguments.length||"function"!=typeof arguments[0]))return _.apply(this,[]);var O=function(A){var N={},F=A.result();return F.forEach(function(z){var B={id:z.id,timestamp:z.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[z.type]||z.type};z.names().forEach(function(V){B[V]=z.stat(V)}),N[B.id]=B}),N},U=function(A){return new Map(Object.keys(A).map(function(N){return[N,A[N]]}))};if(2<=arguments.length){var G=function(A){D[1](U(O(A)))};return _.apply(this,[G,arguments[0]])}return new Promise(function(A,N){_.apply(w,[function(F){A(U(O(F)))},N])}).then(M,I)},51>k.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(L){var M=P.RTCPeerConnection.prototype[L];P.RTCPeerConnection.prototype[L]=function(){var I=arguments,w=this,D=new Promise(function(O,U){M.apply(w,[I[0],O,U])});return 2>I.length?D:D.then(function(){I[1].apply(null,[])},function(O){3<=I.length&&I[2].apply(null,[O])})}}),52>k.version&&["createOffer","createAnswer"].forEach(function(L){var M=P.RTCPeerConnection.prototype[L];P.RTCPeerConnection.prototype[L]=function(){var I=this;if(1>arguments.length||1===arguments.length&&"object"===_typeof(arguments[0])){var w=1===arguments.length?arguments[0]:void 0;return new Promise(function(D,O){M.apply(I,[D,O,w])})}return M.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(L){var M=P.RTCPeerConnection.prototype[L];P.RTCPeerConnection.prototype[L]=function(){return arguments[0]=new("addIceCandidate"===L?P.RTCIceCandidate:P.RTCSessionDescription)(arguments[0]),M.apply(this,arguments)}});var x=P.RTCPeerConnection.prototype.addIceCandidate;P.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?x.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}}},{"../utils.js":13,"./getusermedia":6}],6:[function(C,y){"use strict";var S=C("../utils.js"),R=S.log;y.exports=function(P){var k=S.detectBrowser(P),E=P&&P.navigator,_=function(D){if("object"!==("undefined"==typeof D?"undefined":_typeof(D))||D.mandatory||D.optional)return D;var O={};return Object.keys(D).forEach(function(U){if("require"!==U&&"advanced"!==U&&"mediaSource"!==U){var G="object"===_typeof(D[U])?D[U]:{ideal:D[U]};void 0!==G.exact&&"number"==typeof G.exact&&(G.min=G.max=G.exact);var A=function(F,z){return F?F+z.charAt(0).toUpperCase()+z.slice(1):"deviceId"===z?"sourceId":z};if(void 0!==G.ideal){O.optional=O.optional||[];var N={};"number"==typeof G.ideal?(N[A("min",U)]=G.ideal,O.optional.push(N),N={},N[A("max",U)]=G.ideal,O.optional.push(N)):(N[A("",U)]=G.ideal,O.optional.push(N))}void 0!==G.exact&&"number"!=typeof G.exact?(O.mandatory=O.mandatory||{},O.mandatory[A("",U)]=G.exact):["min","max"].forEach(function(F){void 0!==G[F]&&(O.mandatory=O.mandatory||{},O.mandatory[A(F,U)]=G[F])})}}),D.advanced&&(O.optional=(O.optional||[]).concat(D.advanced)),O},x=function(D,O){if(61<=k.version)return O(D);if(D=JSON.parse(JSON.stringify(D)),D&&"object"===_typeof(D.audio)){var U=function(F,z,B){z in F&&!(B in F)&&(F[B]=F[z],delete F[z])};D=JSON.parse(JSON.stringify(D)),U(D.audio,"autoGainControl","googAutoGainControl"),U(D.audio,"noiseSuppression","googNoiseSuppression"),D.audio=_(D.audio)}if(D&&"object"===_typeof(D.video)){var G=D.video.facingMode;G=G&&("object"===("undefined"==typeof G?"undefined":_typeof(G))?G:{ideal:G});var A=66>k.version;if(G&&("user"===G.exact||"environment"===G.exact||"user"===G.ideal||"environment"===G.ideal)&&!(E.mediaDevices.getSupportedConstraints&&E.mediaDevices.getSupportedConstraints().facingMode&&!A)){delete D.video.facingMode;var N;if("environment"===G.exact||"environment"===G.ideal?N=["back","rear"]:("user"===G.exact||"user"===G.ideal)&&(N=["front"]),N)return E.mediaDevices.enumerateDevices().then(function(F){F=F.filter(function(B){return"videoinput"===B.kind});var z=F.find(function(B){return N.some(function(V){return-1!==B.label.toLowerCase().indexOf(V)})});return!z&&F.length&&-1!==N.indexOf("back")&&(z=F[F.length-1]),z&&(D.video.deviceId=G.exact?{exact:z.deviceId}:{ideal:z.deviceId}),D.video=_(D.video),R("chrome: "+JSON.stringify(D)),O(D)})}D.video=_(D.video)}return R("chrome: "+JSON.stringify(D)),O(D)},L=function(D){return{name:{PermissionDeniedError:"NotAllowedError",InvalidStateError:"NotReadableError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotReadableError",MediaDeviceKillSwitchOn:"NotReadableError"}[D.name]||D.name,message:D.message,constraint:D.constraintName,toString:function toString(){return this.name+(this.message&&": ")+this.message}}};E.getUserMedia=function M(D,O,U){x(D,function(G){E.webkitGetUserMedia(G,O,function(A){U&&U(L(A))})})};var I=function(D){return new Promise(function(O,U){E.getUserMedia(D,O,U)})};if(E.mediaDevices||(E.mediaDevices={getUserMedia:I,enumerateDevices:function enumerateDevices(){return new Promise(function(D){var O={audio:"audioinput",video:"videoinput"};return P.MediaStreamTrack.getSources(function(U){D(U.map(function(G){return{label:G.label,kind:O[G.kind],deviceId:G.id,groupId:""}}))})})},getSupportedConstraints:function getSupportedConstraints(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),!E.mediaDevices.getUserMedia)E.mediaDevices.getUserMedia=function(D){return I(D)};else{var w=E.mediaDevices.getUserMedia.bind(E.mediaDevices);E.mediaDevices.getUserMedia=function(D){return x(D,function(O){return w(O).then(function(U){if(O.audio&&!U.getAudioTracks().length||O.video&&!U.getVideoTracks().length)throw U.getTracks().forEach(function(G){G.stop()}),new DOMException("","NotFoundError");return U},function(U){return Promise.reject(L(U))})})}}"undefined"==typeof E.mediaDevices.addEventListener&&(E.mediaDevices.addEventListener=function(){R("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof E.mediaDevices.removeEventListener&&(E.mediaDevices.removeEventListener=function(){R("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":13}],7:[function(C,y){"use strict";var S=C("sdp"),R=C("./utils");y.exports={shimRTCIceCandidate:function shimRTCIceCandidate(P){if(!(P.RTCIceCandidate&&"foundation"in P.RTCIceCandidate.prototype)){var k=P.RTCIceCandidate;P.RTCIceCandidate=function(E){"object"===("undefined"==typeof E?"undefined":_typeof(E))&&E.candidate&&0===E.candidate.indexOf("a=")&&(E=JSON.parse(JSON.stringify(E)),E.candidate=E.candidate.substr(2));var _=new k(E),x=S.parseCandidate(E.candidate),L=Object.assign(_,x);return L.toJSON=function(){return{candidate:L.candidate,sdpMid:L.sdpMid,sdpMLineIndex:L.sdpMLineIndex,usernameFragment:L.usernameFragment}},L},R.wrapPeerConnectionEvent(P,"icecandidate",function(E){return E.candidate&&Object.defineProperty(E,"candidate",{value:new P.RTCIceCandidate(E.candidate),writable:"false"}),E})}},shimCreateObjectURL:function shimCreateObjectURL(P){var k=P&&P.URL;if("object"===("undefined"==typeof P?"undefined":_typeof(P))&&P.HTMLMediaElement&&"srcObject"in P.HTMLMediaElement.prototype&&k.createObjectURL&&k.revokeObjectURL){var E=k.createObjectURL.bind(k),_=k.revokeObjectURL.bind(k),x=new Map,L=0;k.createObjectURL=function(w){if("getTracks"in w){var D="polyblob:"+ ++L;return x.set(D,w),R.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),D}return E(w)},k.revokeObjectURL=function(w){_(w),x.delete(w)};var M=Object.getOwnPropertyDescriptor(P.HTMLMediaElement.prototype,"src");Object.defineProperty(P.HTMLMediaElement.prototype,"src",{get:function get(){return M.get.apply(this)},set:function set(w){return this.srcObject=x.get(w)||null,M.set.apply(this,[w])}});var I=P.HTMLMediaElement.prototype.setAttribute;P.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=x.get(arguments[1])||null),I.apply(this,arguments)}}},shimMaxMessageSize:function shimMaxMessageSize(P){if(!P.RTCSctpTransport&&P.RTCPeerConnection){var k=R.detectBrowser(P);"sctp"in P.RTCPeerConnection.prototype||Object.defineProperty(P.RTCPeerConnection.prototype,"sctp",{get:function get(){return"undefined"==typeof this._sctp?null:this._sctp}});var E=function(I){var w=S.splitSections(I.sdp);return w.shift(),w.some(function(D){var O=S.parseMLine(D);return O&&"application"===O.kind&&-1!==O.protocol.indexOf("SCTP")})},_=function(I){var w=I.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===w||2>w.length)return-1;var D=parseInt(w[1],10);return D===D?D:-1},x=function(I){var w=65536;return"firefox"===k.browser&&(57>k.version?-1===I?w=16384:w=2147483637:w=57===k.version?65535:65536),w},L=function(I,w){var D=65536;"firefox"===k.browser&&57===k.version&&(D=65535);var O=S.matchPrefix(I.sdp,"a=max-message-size:");return 0<O.length?D=parseInt(O[0].substr(19),10):"firefox"===k.browser&&-1!==w&&(D=2147483637),D},M=P.RTCPeerConnection.prototype.setRemoteDescription;P.RTCPeerConnection.prototype.setRemoteDescription=function(){var I=this;if(I._sctp=null,E(arguments[0])){var U,w=_(arguments[0]),D=x(w),O=L(arguments[0],w);U=0===D&&0===O?Number.POSITIVE_INFINITY:0===D||0===O?Math.max(D,O):Math.min(D,O);var G={};Object.defineProperty(G,"maxMessageSize",{get:function get(){return U}}),I._sctp=G}return M.apply(I,arguments)}}},shimSendThrowTypeError:function shimSendThrowTypeError(P){var k=P.RTCPeerConnection.prototype.createDataChannel;P.RTCPeerConnection.prototype.createDataChannel=function(){var E=this,_=k.apply(E,arguments),x=_.send;return _.send=function(){var L=this,M=arguments[0],I=M.length||M.size||M.byteLength;if(I>E.sctp.maxMessageSize)throw new DOMException("Message too large (can send a maximum of "+E.sctp.maxMessageSize+" bytes)","TypeError");return x.apply(L,arguments)},_}}}},{"./utils":13,sdp:2}],8:[function(C,y){"use strict";var S=C("../utils"),R=C("rtcpeerconnection-shim");y.exports={shimGetUserMedia:C("./getusermedia"),shimPeerConnection:function shimPeerConnection(P){var k=S.detectBrowser(P);if(P.RTCIceGatherer&&(P.RTCIceCandidate||(P.RTCIceCandidate=function(_){return _}),P.RTCSessionDescription||(P.RTCSessionDescription=function(_){return _}),15025>k.version)){var E=Object.getOwnPropertyDescriptor(P.MediaStreamTrack.prototype,"enabled");Object.defineProperty(P.MediaStreamTrack.prototype,"enabled",{set:function set(_){E.set.call(this,_);var x=new Event("enabled");x.enabled=_,this.dispatchEvent(x)}})}P.RTCRtpSender&&!("dtmf"in P.RTCRtpSender.prototype)&&Object.defineProperty(P.RTCRtpSender.prototype,"dtmf",{get:function get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new P.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),P.RTCPeerConnection=R(P,k.version)},shimReplaceTrack:function shimReplaceTrack(P){P.RTCRtpSender&&!("replaceTrack"in P.RTCRtpSender.prototype)&&(P.RTCRtpSender.prototype.replaceTrack=P.RTCRtpSender.prototype.setTrack)}}},{"../utils":13,"./getusermedia":9,"rtcpeerconnection-shim":1}],9:[function(C,y){"use strict";y.exports=function(S){var R=S&&S.navigator,P=function(E){return{name:{PermissionDeniedError:"NotAllowedError"}[E.name]||E.name,message:E.message,constraint:E.constraint,toString:function toString(){return this.name}}},k=R.mediaDevices.getUserMedia.bind(R.mediaDevices);R.mediaDevices.getUserMedia=function(E){return k(E).catch(function(_){return Promise.reject(P(_))})}}},{}],10:[function(C,y){"use strict";var S=C("../utils");y.exports={shimGetUserMedia:C("./getusermedia"),shimOnTrack:function shimOnTrack(R){"object"===("undefined"==typeof R?"undefined":_typeof(R))&&R.RTCPeerConnection&&!("ontrack"in R.RTCPeerConnection.prototype)&&Object.defineProperty(R.RTCPeerConnection.prototype,"ontrack",{get:function get(){return this._ontrack},set:function set(P){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=P),this.addEventListener("addstream",this._ontrackpoly=function(k){k.stream.getTracks().forEach(function(E){var _=new Event("track");_.track=E,_.receiver={track:E},_.transceiver={receiver:_.receiver},_.streams=[k.stream],this.dispatchEvent(_)}.bind(this))}.bind(this))}}),"object"===("undefined"==typeof R?"undefined":_typeof(R))&&R.RTCTrackEvent&&"receiver"in R.RTCTrackEvent.prototype&&!("transceiver"in R.RTCTrackEvent.prototype)&&Object.defineProperty(R.RTCTrackEvent.prototype,"transceiver",{get:function get(){return{receiver:this.receiver}}})},shimSourceObject:function shimSourceObject(R){"object"===("undefined"==typeof R?"undefined":_typeof(R))&&R.HTMLMediaElement&&!("srcObject"in R.HTMLMediaElement.prototype)&&Object.defineProperty(R.HTMLMediaElement.prototype,"srcObject",{get:function get(){return this.mozSrcObject},set:function set(P){this.mozSrcObject=P}})},shimPeerConnection:function shimPeerConnection(R){var P=S.detectBrowser(R);if("object"===("undefined"==typeof R?"undefined":_typeof(R))&&(R.RTCPeerConnection||R.mozRTCPeerConnection)){R.RTCPeerConnection||(R.RTCPeerConnection=function(L,M){if(38>P.version&&L&&L.iceServers){for(var D,I=[],w=0;w<L.iceServers.length;w++)if(D=L.iceServers[w],D.hasOwnProperty("urls"))for(var U,O=0;O<D.urls.length;O++)U={url:D.urls[O]},0===D.urls[O].indexOf("turn")&&(U.username=D.username,U.credential=D.credential),I.push(U);else I.push(L.iceServers[w]);L.iceServers=I}return new R.mozRTCPeerConnection(L,M)},R.RTCPeerConnection.prototype=R.mozRTCPeerConnection.prototype,R.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(R.RTCPeerConnection,"generateCertificate",{get:function get(){return R.mozRTCPeerConnection.generateCertificate}}),R.RTCSessionDescription=R.mozRTCSessionDescription,R.RTCIceCandidate=R.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(L){var M=R.RTCPeerConnection.prototype[L];R.RTCPeerConnection.prototype[L]=function(){return arguments[0]=new("addIceCandidate"===L?R.RTCIceCandidate:R.RTCSessionDescription)(arguments[0]),M.apply(this,arguments)}});var k=R.RTCPeerConnection.prototype.addIceCandidate;R.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?k.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var E=function(L){var M=new Map;return Object.keys(L).forEach(function(I){M.set(I,L[I]),M[I]=L[I]}),M},_={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},x=R.RTCPeerConnection.prototype.getStats;R.RTCPeerConnection.prototype.getStats=function(L,M,I){return x.apply(this,[L||null]).then(function(w){if(48>P.version&&(w=E(w)),53>P.version&&!M)try{w.forEach(function(D){D.type=_[D.type]||D.type})}catch(D){if("TypeError"!==D.name)throw D;w.forEach(function(O,U){w.set(U,Object.assign({},O,{type:_[O.type]||O.type}))})}return w}).then(M,I)}}},shimRemoveStream:function shimRemoveStream(R){!R.RTCPeerConnection||"removeStream"in R.RTCPeerConnection.prototype||(R.RTCPeerConnection.prototype.removeStream=function(P){var k=this;S.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(E){E.track&&-1!==P.getTracks().indexOf(E.track)&&k.removeTrack(E)})})}}},{"../utils":13,"./getusermedia":11}],11:[function(C,y){"use strict";var S=C("../utils"),R=S.log;y.exports=function(P){var k=S.detectBrowser(P),E=P&&P.navigator,_=P&&P.MediaStreamTrack,x=function(A){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[A.name]||A.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[A.message]||A.message,constraint:A.constraint,toString:function toString(){return this.name+(this.message&&": ")+this.message}}},L=function(A,N,F){var z=function(B){if("object"!==("undefined"==typeof B?"undefined":_typeof(B))||B.require)return B;var V=[];return Object.keys(B).forEach(function(H){if("require"!==H&&"advanced"!==H&&"mediaSource"!==H){var W=B[H]="object"===_typeof(B[H])?B[H]:{ideal:B[H]};if((void 0!==W.min||void 0!==W.max||void 0!==W.exact)&&V.push(H),void 0!==W.exact&&("number"==typeof W.exact?W.min=W.max=W.exact:B[H]=W.exact,delete W.exact),void 0!==W.ideal){B.advanced=B.advanced||[];var q={};q[H]="number"==typeof W.ideal?{min:W.ideal,max:W.ideal}:W.ideal,B.advanced.push(q),delete W.ideal,Object.keys(W).length||delete B[H]}}}),V.length&&(B.require=V),B};return A=JSON.parse(JSON.stringify(A)),38>k.version&&(R("spec: "+JSON.stringify(A)),A.audio&&(A.audio=z(A.audio)),A.video&&(A.video=z(A.video)),R("ff37: "+JSON.stringify(A))),E.mozGetUserMedia(A,N,function(B){F(x(B))})};if(E.mediaDevices||(E.mediaDevices={getUserMedia:function M(A){return new Promise(function(N,F){L(A,N,F)})},addEventListener:function addEventListener(){},removeEventListener:function removeEventListener(){}}),E.mediaDevices.enumerateDevices=E.mediaDevices.enumerateDevices||function(){return new Promise(function(A){A([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},41>k.version){var I=E.mediaDevices.enumerateDevices.bind(E.mediaDevices);E.mediaDevices.enumerateDevices=function(){return I().then(void 0,function(A){if("NotFoundError"===A.name)return[];throw A})}}if(49>k.version){var w=E.mediaDevices.getUserMedia.bind(E.mediaDevices);E.mediaDevices.getUserMedia=function(A){return w(A).then(function(N){if(A.audio&&!N.getAudioTracks().length||A.video&&!N.getVideoTracks().length)throw N.getTracks().forEach(function(F){F.stop()}),new DOMException("The object can not be found here.","NotFoundError");return N},function(N){return Promise.reject(x(N))})}}if(!(55<k.version&&"autoGainControl"in E.mediaDevices.getSupportedConstraints())){var D=function(A,N,F){N in A&&!(F in A)&&(A[F]=A[N],delete A[N])},O=E.mediaDevices.getUserMedia.bind(E.mediaDevices);if(E.mediaDevices.getUserMedia=function(A){return"object"===("undefined"==typeof A?"undefined":_typeof(A))&&"object"===_typeof(A.audio)&&(A=JSON.parse(JSON.stringify(A)),D(A.audio,"autoGainControl","mozAutoGainControl"),D(A.audio,"noiseSuppression","mozNoiseSuppression")),O(A)},_&&_.prototype.getSettings){var U=_.prototype.getSettings;_.prototype.getSettings=function(){var A=U.apply(this,arguments);return D(A,"mozAutoGainControl","autoGainControl"),D(A,"mozNoiseSuppression","noiseSuppression"),A}}if(_&&_.prototype.applyConstraints){var G=_.prototype.applyConstraints;_.prototype.applyConstraints=function(A){return"audio"===this.kind&&"object"===("undefined"==typeof A?"undefined":_typeof(A))&&(A=JSON.parse(JSON.stringify(A)),D(A,"autoGainControl","mozAutoGainControl"),D(A,"noiseSuppression","mozNoiseSuppression")),G.apply(this,[A])}}}E.getUserMedia=function(A,N,F){return 44>k.version?L(A,N,F):void(S.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),E.mediaDevices.getUserMedia(A).then(N,F))}}},{"../utils":13}],12:[function(C,y){"use strict";var S=C("../utils");y.exports={shimLocalStreamsAPI:function shimLocalStreamsAPI(R){if("object"===("undefined"==typeof R?"undefined":_typeof(R))&&R.RTCPeerConnection){if("getLocalStreams"in R.RTCPeerConnection.prototype||(R.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in R.RTCPeerConnection.prototype||(R.RTCPeerConnection.prototype.getStreamById=function(k){var E=null;return this._localStreams&&this._localStreams.forEach(function(_){_.id===k&&(E=_)}),this._remoteStreams&&this._remoteStreams.forEach(function(_){_.id===k&&(E=_)}),E}),!("addStream"in R.RTCPeerConnection.prototype)){var P=R.RTCPeerConnection.prototype.addTrack;R.RTCPeerConnection.prototype.addStream=function(k){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(k)&&this._localStreams.push(k);var E=this;k.getTracks().forEach(function(_){P.call(E,_,k)})},R.RTCPeerConnection.prototype.addTrack=function(k,E){return E&&(this._localStreams?-1===this._localStreams.indexOf(E)&&this._localStreams.push(E):this._localStreams=[E]),P.call(this,k,E)}}"removeStream"in R.RTCPeerConnection.prototype||(R.RTCPeerConnection.prototype.removeStream=function(k){this._localStreams||(this._localStreams=[]);var E=this._localStreams.indexOf(k);if(-1!==E){this._localStreams.splice(E,1);var _=this,x=k.getTracks();this.getSenders().forEach(function(L){-1!==x.indexOf(L.track)&&_.removeTrack(L)})}})}},shimRemoteStreamsAPI:function shimRemoteStreamsAPI(R){"object"===("undefined"==typeof R?"undefined":_typeof(R))&&R.RTCPeerConnection&&(!("getRemoteStreams"in R.RTCPeerConnection.prototype)&&(R.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in R.RTCPeerConnection.prototype)&&Object.defineProperty(R.RTCPeerConnection.prototype,"onaddstream",{get:function get(){return this._onaddstream},set:function set(P){var k=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=P),this.addEventListener("track",this._onaddstreampoly=function(E){E.streams.forEach(function(_){if(k._remoteStreams||(k._remoteStreams=[]),!(0<=k._remoteStreams.indexOf(_))){k._remoteStreams.push(_);var x=new Event("addstream");x.stream=_,k.dispatchEvent(x)}})})}}))},shimCallbacksAPI:function shimCallbacksAPI(R){if("object"===("undefined"==typeof R?"undefined":_typeof(R))&&R.RTCPeerConnection){var P=R.RTCPeerConnection.prototype,k=P.createOffer,E=P.createAnswer,_=P.setLocalDescription,x=P.setRemoteDescription,L=P.addIceCandidate;P.createOffer=function(I,w){var D=2<=arguments.length?arguments[2]:arguments[0],O=k.apply(this,[D]);return w?(O.then(I,w),Promise.resolve()):O},P.createAnswer=function(I,w){var D=2<=arguments.length?arguments[2]:arguments[0],O=E.apply(this,[D]);return w?(O.then(I,w),Promise.resolve()):O};var M=function withCallback(I,w,D){var O=_.apply(this,[I]);return D?(O.then(w,D),Promise.resolve()):O};P.setLocalDescription=M,M=function withCallback(I,w,D){var O=x.apply(this,[I]);return D?(O.then(w,D),Promise.resolve()):O},P.setRemoteDescription=M,M=function withCallback(I,w,D){var O=L.apply(this,[I]);return D?(O.then(w,D),Promise.resolve()):O},P.addIceCandidate=M}},shimGetUserMedia:function shimGetUserMedia(R){var P=R&&R.navigator;P.getUserMedia||(P.webkitGetUserMedia?P.getUserMedia=P.webkitGetUserMedia.bind(P):P.mediaDevices&&P.mediaDevices.getUserMedia&&(P.getUserMedia=function(k,E,_){P.mediaDevices.getUserMedia(k).then(E,_)}.bind(P)))},shimRTCIceServerUrls:function shimRTCIceServerUrls(R){var P=R.RTCPeerConnection;R.RTCPeerConnection=function(k,E){if(k&&k.iceServers){for(var L,_=[],x=0;x<k.iceServers.length;x++)L=k.iceServers[x],!L.hasOwnProperty("urls")&&L.hasOwnProperty("url")?(S.deprecated("RTCIceServer.url","RTCIceServer.urls"),L=JSON.parse(JSON.stringify(L)),L.urls=L.url,delete L.url,_.push(L)):_.push(k.iceServers[x]);k.iceServers=_}return new P(k,E)},R.RTCPeerConnection.prototype=P.prototype,"generateCertificate"in R.RTCPeerConnection&&Object.defineProperty(R.RTCPeerConnection,"generateCertificate",{get:function get(){return P.generateCertificate}})},shimTrackEventTransceiver:function shimTrackEventTransceiver(R){"object"===("undefined"==typeof R?"undefined":_typeof(R))&&R.RTCPeerConnection&&"receiver"in R.RTCTrackEvent.prototype&&!R.RTCTransceiver&&Object.defineProperty(R.RTCTrackEvent.prototype,"transceiver",{get:function get(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function shimCreateOfferLegacy(R){var P=R.RTCPeerConnection.prototype.createOffer;R.RTCPeerConnection.prototype.createOffer=function(k){var E=this;if(k){var _=E.getTransceivers().find(function(L){return L.sender.track&&"audio"===L.sender.track.kind});!1===k.offerToReceiveAudio&&_?"sendrecv"===_.direction?_.setDirection?_.setDirection("sendonly"):_.direction="sendonly":"recvonly"===_.direction&&(_.setDirection?_.setDirection("inactive"):_.direction="inactive"):!0===k.offerToReceiveAudio&&!_&&E.addTransceiver("audio");var x=E.getTransceivers().find(function(L){return L.sender.track&&"video"===L.sender.track.kind});!1===k.offerToReceiveVideo&&x?"sendrecv"===x.direction?x.setDirection("sendonly"):"recvonly"===x.direction&&x.setDirection("inactive"):!0===k.offerToReceiveVideo&&!x&&E.addTransceiver("video")}return P.apply(E,arguments)}}}},{"../utils":13}],13:[function(C,y){"use strict";function S(E,_,x){var L=E.match(_);return L&&L.length>=x&&parseInt(L[x],10)}var P=!0,k=!0;y.exports={extractVersion:S,wrapPeerConnectionEvent:function(E,_,x){if(E.RTCPeerConnection){var L=E.RTCPeerConnection.prototype,M=L.addEventListener;L.addEventListener=function(w,D){if(w!==_)return M.apply(this,arguments);var O=function(U){D(x(U))};return this._eventMap=this._eventMap||{},this._eventMap[D]=O,M.apply(this,[w,O])};var I=L.removeEventListener;L.removeEventListener=function(w,D){if(w!==_||!this._eventMap||!this._eventMap[D])return I.apply(this,arguments);var O=this._eventMap[D];return delete this._eventMap[D],I.apply(this,[w,O])},Object.defineProperty(L,"on"+_,{get:function get(){return this["_on"+_]},set:function set(w){this["_on"+_]&&(this.removeEventListener(_,this["_on"+_]),delete this["_on"+_]),w&&this.addEventListener(_,this["_on"+_]=w)}})}},disableLog:function disableLog(E){return"boolean"==typeof E?(P=E,E?"adapter.js logging disabled":"adapter.js logging enabled"):new Error("Argument type: "+("undefined"==typeof E?"undefined":_typeof(E))+". Please use a boolean.")},disableWarnings:function disableWarnings(E){return"boolean"==typeof E?(k=!E,"adapter.js deprecation warnings "+(E?"disabled":"enabled")):new Error("Argument type: "+("undefined"==typeof E?"undefined":_typeof(E))+". Please use a boolean.")},log:function log(){if("object"===("undefined"==typeof window?"undefined":_typeof(window))){if(P)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function deprecated(E,_){k&&console.warn(E+" is deprecated, please use "+_+" instead.")},detectBrowser:function detectBrowser(E){var _=E&&E.navigator,x={};if(x.browser=null,x.version=null,"undefined"==typeof E||!E.navigator)return x.browser="Not a browser.",x;if(_.mozGetUserMedia)x.browser="firefox",x.version=S(_.userAgent,/Firefox\/(\d+)\./,1);else if(_.webkitGetUserMedia)x.browser="chrome",x.version=S(_.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(_.mediaDevices&&_.userAgent.match(/Edge\/(\d+).(\d+)$/))x.browser="edge",x.version=S(_.userAgent,/Edge\/(\d+).(\d+)$/,2);else if(_.mediaDevices&&_.userAgent.match(/AppleWebKit\/(\d+)\./))x.browser="safari",x.version=S(_.userAgent,/AppleWebKit\/(\d+)\./,1);else return x.browser="Not a supported browser.",x;return x}}},{}]},{},[3])(3)});
    </script>

    <!--<script src="https://remoteme.org/public/libs/remoteme/control.js"></script>-->
    <script type="text/javascript">
        "use strict";var _createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var Control=function(){function a(b,c,d,e){_classCallCheck(this,a),this.isRunning=!1,this.minGlobal=b,this.maxGlobal=c,0>=d&&(d=1),this.steps=d,this.min=b/d,this.max=c/d,this.currentValue=0,this.mode=0,this.prevMode=0,this.counter=0,this.idleCounter=0,this.callOnChange=e,this.idleWait=3,this.accelerate=4,this.freeAccelerate=0.75,this.ignoreSteps=!1}return _createClass(a,[{key:"runFunction",value:function runFunction(b,c){(!b.isRunning||c)&&setTimeout(b.calculate,100,b)}},{key:"setMode",value:function setMode(b,c){if(this.mode!=b){if(this.counter=0,this.runFunction(this),this.mode=b,this.prevMode!=b&&0!=b&&(this.idleCounter=0),1<this.steps&&0!=b)if(c)console.info("ignore steps"),this.min=this.minGlobal,this.max=this.maxGlobal;else{var d,e,f;1==b?(d=this.maxGlobal,e=this.max,f=this.currentValue):-1==b&&(d=-this.minGlobal,e=-this.min,f=-this.currentValue);var g=d/this.steps,h=Math.trunc(f/g);e=(h+1)*g,e=Math.min(d,e),1==b?(this.max=e,console.info("new max "+e)):-1==b&&(this.min=-e,console.info("new min "+e))}this.prevMode=b}}}]),_createClass(a,[{key:"calculate",value:function calculate(b){b.counter++;var c=b.counter;b.isRunning=!0;var d=b.currentValue;if(0!=b.mode)1==b.mode?0>d?(d=0,b.isRunning=!1):(d+=b.accelerate*c,d=Math.min(b.max,d)):-1==b.mode&&(0<d?(d=0,b.isRunning=!1):(d-=b.accelerate*c,d=Math.max(b.min,d)));else if(0==d)b.isRunning=!1;else if(b.idleCounter<=b.idleWait)b.idleCounter++;else{c-=b.idleCounter;var e=0>d?-1:1;d*=e,d-=b.freeAccelerate*c,d=Math.max(0,d),d*=e}d=Math.trunc(d),b.currentValue!=d&&(b.currentValue=d,0>d?b.callOnChange(-d/b.minGlobal):b.callOnChange(d/b.maxGlobal)),b.isRunning&&b.runFunction(b,!0)}}]),a}();
    </script>

    <!--<script src="https://remoteme.org/public/libs/remoteme/gauge.js"></script>-->
    <script type="text/javascript">
        "use strict";var _createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var DotPosition=function(){function a(b,c,d){_classCallCheck(this,a),this.container=$("#"+b),this.width=c,this.height=d;this.container.css({opacity:"0.5",width:c+"px",height:d+"px",border:"1px solid #bb0014",position:"absolute",right:"0px",top:"0px",overflow:"hidden"}),this.dot=$("<div></div>"),this.dot.css({position:"relative",top:"0px",left:"0px",width:"10px",height:"10px",border:"1px solid red","background-color":"red","border-radius":"5px"}),this.container.append(this.dot),this.text=$("<div></div>"),this.text.css({position:"relative",top:"0px",left:"0px","font-size":"12pt","line-height":"9pt","margin-top":"-5pt","padding-top":"0px",color:"red","font-family":"Courier New, monospace"}),this.text.html(""),this.container.append(this.text),this.setPosition(0,0)}return _createClass(a,[{key:"setPosition",value:function setPosition(b,c){this.dot.css("left",this.width*b-6+"px"),this.dot.css("top",this.height*c-6+"px"),this.text.html("x="+Math.round(200*b-100)+"<br/>y="+Math.round(200*c-100))}}]),a}(),TurnMeter=function(){function a(b,c,d){_classCallCheck(this,a);var e=[];e.push("min"),e.push(0),e.push("max"),this.gauge=new LinearGauge({renderTo:b,width:c,height:d,minValue:-255,maxValue:255,majorTicks:e,minorTicks:5,colorPlate:"#fff",borderShadowWidth:0,borders:!1,barBeginCircle:!1,tickSide:"left",numberSide:"left",needleSide:"left",needleType:"arrow",needleWidth:12,highlights:[],colorNeedle:"#dd0031",animationDuration:-1,animationRule:"linear",animationTarget:"plate",barWidth:0,ticksWidth:10,ticksWidthMinor:5}).draw()}return _createClass(a,[{key:"setValue",value:function setValue(b){this.gauge.value=b}}]),a}(),SpeedMeter=function(){function a(b,c,d,e){_classCallCheck(this,a);for(var g=["min"],f=-200;200>=f;f+=50)g.push(f+"");g.push("max"),this.gauge=new RadialGauge({renderTo:b,width:d,height:e,units:c,minValue:-255,maxValue:255,majorTicks:g,minorTicks:2,strokeTicks:!0,highlights:[{from:200,to:255,color:"#dd0031"},{from:120,to:200,color:"#FFAD00"},{from:-255,to:-200,color:"#dd0031"},{from:-200,to:-120,color:"#FFAD00"}],colorPlate:"#fff",borderShadowWidth:0,borders:!1,needleType:"arrow",needleWidth:2,needleCircleSize:7,needleCircleOuter:!0,needleCircleInner:!1,animationDuration:-1,animationRule:"linear"}).draw()}return _createClass(a,[{key:"setValue",value:function setValue(b){this.gauge.value=b}}]),a}();
    </script>

    <!--<script src="https://remoteme.org/public/libs/remoteme/operationTimer.js"></script>-->
    <script type="text/javascript">
        'use strict';var _createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,'value'in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var OperationTimer=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:200;_classCallCheck(this,a),this.toExecute=[],this.executeDelay=[],this.timers=[],this.defaultDelay=b}return _createClass(a,[{key:'setDelayForFunction',value:function setDelayForFunction(b,c){this.executeDelay[b.name]=c}},{key:'setDefaultDelay',value:function setDefaultDelay(b){this.defaultDelay=b}},{key:'execute',value:function execute(b){for(var e=arguments.length,c=Array(1<e?e-1:0),f=1;f<e;f++)c[f-1]=arguments[f];var d=b.name;void 0==this.timers[d]?(b.apply(void 0,c),this._setTimeout(this,d)):this.toExecute[d]={fun:b,parameters:c}}},{key:'_setTimeout',value:function _setTimeout(b,c){var d=b.executeDelay[c];void 0==d&&(d=b.defaultDelay),b.timers[c]=setTimeout(b._executeNow,d,b,c)}},{key:'_executeNow',value:function _executeNow(b,c){var d=b.toExecute[c];b.toExecute[c]=void 0,void 0==d?b.timers[c]=void 0:(d.fun.apply(void 0,d.parameters),b._setTimeout(b,c))}}]),a}();
    </script>

<!--    <script src="https://remoteme.org/public/libs/remoteme/carController4WD.js"></script>-->
    <script type="text/javascript">
        "use strict";var _createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var CarController4WD=function(){function a(){_classCallCheck(this,a),this.turn=0,this.speed=0,this.cameraX=0,this.cameraY=0,this.ignoreBackwardMode=!1,this.cameraXDirection=-1,this.cameraYDirection=1}return _createClass(a,[{key:"normalize",value:function normalize(b){return Math.min(1,Math.max(-1,b))}},{key:"setSpeed",value:function setSpeed(b){this.speed=this.normalize(b)}},{key:"setTurn",value:function setTurn(b){this.turn=this.normalize(b)}},{key:"compute",value:function compute(){this.leftSpeed=this.speed,this.rightSpeed=this.speed;var b;b=this.ignoreBackwardMode?1:0>this.speed?-1:1,this.leftSpeed+=this.turn/b,this.rightSpeed-=this.turn/b,this.leftSpeed=this.normalize(this.leftSpeed),this.rightSpeed=this.normalize(this.rightSpeed)}},{key:"getLeftSideSpeed",value:function getLeftSideSpeed(){return this.leftSpeed}},{key:"getRightSideSpeed",value:function getRightSideSpeed(){return this.rightSpeed}},{key:"getMotorMode",value:function getMotorMode(b){return 0==b?1:0>b?3:2}},{key:"setCameraPosition",value:function setCameraPosition(b,c){this.cameraX=this.normalize(b),this.cameraY=this.normalize(c)}},{key:"getCameraX",value:function getCameraX(){return this.xAxeCenter+this.cameraX*this.xAxeRange*this.cameraXDirection}},{key:"getCameraY",value:function getCameraY(){return this.yAxeCenter+this.cameraY*this.yAxeRange*this.cameraYDirection}}]),a}();
    </script>

    <script>
        <!--var thisDeviceId=####deviceId#;-->
       'use strict';

var thisDeviceId = 1001;
var arduinoId = 203;
var remoteme;

remoteme = new RemoteMe({
    automaticlyConnectWS: true,
    automaticlyConnectWebRTC: false,
    webSocketConnectionChange: webSocketConnectionChange,
    webRTCConnectionChange: null,
    onUserMessage: onUserMessage,
    mediaConstraints: { 'mandatory': { 'OfferToReceiveAudio': false, 'OfferToReceiveVideo': false } }
});
function setup() {
    remoteme = new RemoteMe({
        automaticlyConnectWS: true,
        automaticlyConnectWebRTC: false,
        webSocketConnectionChange: webSocketConnectionChange,
        webRTCConnectionChange: null,
        onUserMessage: onUserMessage,
        mediaConstraints: { 'mandatory': { 'OfferToReceiveAudio': false, 'OfferToReceiveVideo': false } }
    });
}

function onUserMessage(sender, data) {
    var data = new RemoteMeData(data);
    changeDiode(data.popUint8());
}

function changeDiode(state) {
    $("#led").css("background-color", state == 0 ? "white" : "red");
}

function webSocketConnectionChange(state) {

    if (state == WebsocketConnectingStatusEnum.CONNECTED) {
        remoteme.sendUserSyncMessageWebSocket(arduinoId, [], function (data) {
            var data = new RemoteMeData(data);
            changeDiode(data.popUint8());
        });
    }
}

function onLedClick() {
    remoteme.sendUserMessageByFasterChannel(arduinoId, []);
}
    </script>


<!--    <link rel="stylesheet" type="text/css" href="styles.css">-->
</head>

<body>
<!--

<div id="led" style="width:400px;height:400px;border:1px solid gray;border-radius: 400px; cursor: pointer;margin:10px" onclick="onLedClick()"></div>
-->


<!--<script>
	setup();
</script>-->
</body>
</html>